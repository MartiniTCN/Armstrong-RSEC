<!DOCTYPE html>
<html lang="zh-CN" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Armstrong Training Courses</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {}
            }
        };
    </script>

    <link rel="stylesheet" href="style.css"> <!-- è‡ªå®šä¹‰æ ·å¼ -->
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in { animation: fadeIn 0.3s ease-out; }

        .course-card {
            aspect-ratio: 1;
            transition: all 0.3s;
        }
        .course-card:hover {
            transform: scale(1.03) translateY(-4px);
        }
        .course-image {
            transition: transform 0.3s;
        }
        .course-card:hover .course-image {
            transform: scale(1.02);
        }
    </style>

<style>
    /* èƒŒæ™¯å›¾ç‰‡æ ·å¼ */
    .course-page-background {
      background-image: url('https://i.stardots.io/armstrong/webpage.jpg');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      min-height: 100vh; /* ç¡®ä¿èƒŒæ™¯å›¾è¦†ç›–æ•´ä¸ªé¡µé¢ */
    }
  </style>

<style>
    /* èƒ¶å›Šæ ‡ç­¾æ ·å¼ï¼šæ˜äº® + æš—è‰²æ¨¡å¼å…¼å®¹ */
    .tag-capsule {
    display: inline-block;
    padding: 2px 6px;  /* ç¼©å°å†…è¾¹è· */
    font-size: 10px;    /* ç¼©å°å­—ä½“ */
    font-weight: 600;   /* åŠ ç²—æ–‡å­— */
    border-radius: 9999px; /* èƒ¶å›Šå¤–å½¢ */
    line-height: 1;
    white-space: nowrap;
    background-color: #e5d0ff; /* æ›´æŸ”å’Œçš„æµ…ç´«è‰²èƒŒæ™¯ */
    color: #6a0dad;            /* æ›´æ¥è¿‘ç´«è‰²çš„æ·±ç´«è‰²æ–‡å­— */
    }

    /* ğŸŒ™ Dark æ¨¡å¼ï¼šæ·±ç´«è‰²èƒŒæ™¯ï¼Œæµ…ç´«è‰²æ–‡å­— */
    .dark .tag-capsule {
    background-color: #6a0dad; /* æ·±ç´«è‰²èƒŒæ™¯ */
    color: #e5d0ff;            /* æµ…ç´«è‰²æ–‡å­— */
    }
  </style>

</head>
<body class="course-page-background">
    <script>
        const currentUsername = "{{ username }}";  // ä» Flask ä¸­ä¼ é€’è¿‡æ¥çš„å˜é‡
      </script>

<!-- âœ… å¯¼èˆªæ åŒºåŸŸ -->
<div class="sticky top-0 z-50 bg-white/80 dark:bg-gray-800/80 backdrop-blur-xl border-b border-gray-200 dark:border-gray-800">
    <div class="max-w-7xl mx-auto px-4 py-3 sm:py-4">
      <div class="flex flex-col sm:flex-row items-center justify-between gap-3 sm:gap-4">
  
        <!-- âœ… å·¦ä¾§åŒºåŸŸï¼šLogo + æ ‡é¢˜ + åˆ†ç±» + æœç´¢æ¡†ï¼ˆç»Ÿä¸€é å·¦æ’åˆ—ï¼‰ -->
        <div class="flex flex-wrap items-center gap-2 sm:gap-3 w-full sm:w-auto">
          <!-- Logo + æ ‡é¢˜ -->
          <div class="flex items-center gap-2">
            <img src="https://i.stardots.io/armstrong/Armstrong%20Logo%20-%20Martin.png?width=200"
              alt="Armstrong Logo" class="h-8 object-contain" />
            <span class="text-gray-400 text-lg sm:text-xl">|</span>
            <div class="flex items-center gap-1">
              <i class="fas fa-book-open w-4 h-4 sm:w-5 sm:h-5 text-purple-600 dark:text-purple-400"></i>
              <h1 class="text-sm sm:text-base font-semibold text-gray-900 dark:text-white" id="pageTitle">äº§å“è¯¾ç¨‹</h1>
            </div>
          </div>
  
          <!-- åˆ†ç±»ä¸‹æ‹‰æ¡† -->
          <select
            id="categorySelect"
            class="max-w-[100px] px-3 py-1.5 h-7 sm:h-7 text-xs sm:text-sm bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
            style="font-size: 0.65rem !important; font-weight: 600 !important; text-align: center !important;">
            <option value="">æ‰€æœ‰ç±»åˆ«</option>
          </select>
  
          <!-- æœç´¢æ¡† + æŒ‰é’® -->
          <div class="relative flex items-center">
            <button id="searchButton"
              class="w-5 h-5 flex justify-center items-center text-gray-500 dark:text-gray-300 focus:outline-none">
              <i class="fas fa-search"></i>
            </button>
            <input type="text" id="searchInput" placeholder="æœç´¢è¯¾ç¨‹..."
              class="hidden max-w-[100px] pl-3 pr-4 py-1.5 h-7 sm:h-7 text-xs text-gray-900 dark:text-white bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg placeholder-gray-400 focus:ring-2 focus:ring-purple-500 focus:border-transparent" />
          </div>
        </div>
  
        <!-- âœ… å³ä¾§åŒºåŸŸï¼šæ˜æš—æŒ‰é’®ã€è¯­è¨€æŒ‰é’®ã€ç”¨æˆ·å + é€€å‡º -->
        <div class="flex items-center gap-2 sm:gap-3 text-sm text-gray-700 dark:text-gray-300 font-semibold">
          <!-- ğŸŒ™ æ˜æš—æ¨¡å¼ -->
          <button id="themeToggle"
            class="w-5 h-5 flex items-center justify-center rounded-full bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 shadow-md hover:scale-110 transition-transform"
            aria-label="åˆ‡æ¢æ˜æš—æ¨¡å¼">
            <i class="fas fa-sun dark:hidden text-[11px] leading-none"></i>
            <i class="fas fa-moon hidden dark:block text-[11px] leading-none"></i>
          </button>
  
          <!-- ğŸŒ è¯­è¨€åˆ‡æ¢ -->
          <button id="languageToggle" onclick="toggleLang()"
            class="w-5 h-5 flex items-center justify-center rounded-full overflow-hidden bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 shadow-inner hover:scale-110 transition-transform"
            aria-label="åˆ‡æ¢è¯­è¨€">
            <img id="languageFlag" src="https://flagcdn.com/cn.svg" alt="Language" class="w-full h-full object-cover" />
          </button>
  
          <!-- ç”¨æˆ·å + é€€å‡º -->
          <span id="userName">{{ username }}</span>
          <button onclick="handleLogout()" class="text-blue-600 hover:underline text-sm" id="logoutBtn">ï½œ é€€å‡º</button>
        </div>
  
      </div>
    </div>
  </div>

<script>
    // æ˜¾ç¤º/éšè—æœç´¢æ¡†
    document.getElementById("searchButton").addEventListener("click", function() {
        const searchInput = document.getElementById("searchInput");
        searchInput.classList.toggle("hidden");  // åˆ‡æ¢æ˜¾ç¤ºä¸éšè—
        searchInput.focus();  // èšç„¦åˆ°è¾“å…¥æ¡†
    });
</script>


    <!-- Main Content å¯ä»¥è°ƒæ•´å¡ç‰‡å¸ƒå±€-->
    <main class="max-w-7xl mx-auto px-4 py-8">
        <div id="courseGrid" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-3 xl:grid-cols-4 gap-6"> 
            <!-- Courses will be dynamically inserted here -->
        </div>
        <div id="noResults" class="hidden text-center py-12">
            <p class="text-lg text-gray-500 dark:text-gray-400">æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„è¯¾ç¨‹ã€‚</p>
        </div>
    </main>

    <script>
        // Course data
        const courses = [
            {
                id: 1,
                title: {
                    zh: "EE-W æ°´å†·æœºæˆ¿ä¼˜åŒ–æ§åˆ¶",
                    en: "EE-W (IPC9521)"
                },
                description: {
                    zh: "ä¸“ä¸ºé«˜æ•ˆåˆ¶å†·æœºæˆ¿è€Œç”Ÿï¼Œå®ç°æ°´å†·æ°´ä¸»æœºç³»ç»Ÿçš„æ™ºèƒ½ååŒæ§åˆ¶ï¼Œé‡Šæ”¾æœ€ä½³æ€§èƒ½ã€‚",
                    en: "Designed for high-efficiency chiller plants, enabling smart collaboration among chillers to unleash peak performance."
                },
                link: "/course/EE-W" , // âœ… æŒ‡å‘ä½ å®šä¹‰çš„è·¯ç”±
                duration: "2 weeks",
                students: 1234,
                rating: 4.8,
                image: "https://i.stardots.io/armstrong/EE-W.png",
                category: "Optimization"
            },
            {
                id: 2,
                title: {
                    zh: "SE-A ç©ºæ°”æºå†·æ°´æœºç»„ä¼˜åŒ–æ§åˆ¶",
                    en: "SE-A (IPC9511)"
                },
                description: {
                    zh: "ä¸€ä½“åŒ–æ™ºæ§æ ¸å¿ƒï¼Œå®šä¹‰ç©ºæ°”æºå†·æ°´æœºç»„çš„æ–°æ ‡å‡†ã€‚",
                    en: "The integrated brain for air-cooled chillersâ€”simplifying control, maximizing efficiency."
                },
                duration: "1 week",
                students: 856,
                rating: 4.7,
                image: "https://i.stardots.io/armstrong/SE-A.png",
                category: "Optimization"
            },
            {
                id: 3,
                title: {
                    zh: "SE-T é«˜æ•ˆå†·å´ç³»ç»Ÿä¼˜åŒ–æ§åˆ¶",
                    en: "SE-T (ITC9521)"
                },
                description: {
                    zh: "èšç„¦å†·å´å¡”ä¸å†·å´æ³µçš„ä¼˜åŒ–æ§åˆ¶ï¼Œæ‰“é€ æ™ºèƒ½æ•£çƒ­æ–°ä½“éªŒã€‚",
                    en: "Focused on optimizing cooling towers and pumps for intelligent heat rejection."
                },
                duration: "2 weeks",
                students: 945,
                rating: 4.9,
                image: "https://i.stardots.io/armstrong/SE-T%20(ITC9521).png",
                category: "Optimization"
            },
            {
                id: 4,
                title: {
                    zh: "SE-F æ™ºèƒ½æ³µç»„ä¼˜åŒ–æ§åˆ¶",
                    en: "SE-F (IPS4xxxx)"
                },
                description: {
                    zh: "å¤šæ³µæ™ºæ§æ ¸å¿ƒï¼Œç³»ç»Ÿæ›´ç¨³æ›´çœã€‚",
                    en: "The smart core for multi-pump controlâ€”stable, efficient, effortless."
                },
                duration: "1 week",
                students: 678,
                rating: 4.6,
                image: "https://i.stardots.io/armstrong/SE-F%20(IPS).png",
                category: "Optimization"
            },
            {
                id: 5,
                title: {
                    zh: "DE æ™ºèƒ½å˜é¢‘æ³µ",
                    en: "Design Envelope Pump"
                },
                description: {
                    zh: "ä¸åªæ˜¯æ°´æ³µï¼Œæ›´æ˜¯è‡ªæˆ‘è°ƒèŠ‚çš„æ™ºæ…§å¼•æ“ã€‚å®‰è£…å³è¿è¡Œï¼ŒèŠ‚èƒ½é«˜æ•ˆã€‚",
                    en: "More than a pump â€“ a self-optimizing intelligent engine. quick to install, smart to run, built for energy savings in intelligent buildings."
                },
                duration: "2 weeks",
                students: 1567,
                rating: 4.9,
                image: "https://i.stardots.io/armstrong/DE%20PUMPS.png",
                category: "Design Envelope"
            },
            {
                id: 6,
                title: {
                    zh: "iFMS æ™ºèƒ½æµä½“ç®¡ç†ç³»ç»Ÿ",
                    en: "iFMS - Smart Fluid Management System"
                },
                description: {
                    zh: "ä¸€ä½“åŒ–æµçº¿ï¼Œå°†å¤æ‚å·¥ç¨‹è¯¾ç¨‹åŒ–ï¼Œä¸€ç«™å¼äº¤ä»˜é«˜æ•ˆå¯é çš„æ™ºèƒ½æœºæˆ¿ç³»ç»Ÿã€‚",
                    en: "From pump to system, simplifies complex projects into packaged solutions for fast, efficient, and reliable delivery."
                },
                duration: "2 weeks",
                students: 2341,
                rating: 4.8,
                image: "https://i.stardots.io/armstrong/iFMS.png",
                category: "System Integration"
            },
            {
                id: 7,
                title: {
                    zh: "Plumbing Boosterç³»ç»Ÿ",
                    en: "Plumbing 6800Q Booster"
                },
                description: {
                    zh: "æ™ºèƒ½å¢å‹ï¼ŒèŠ‚èƒ½é™éŸ³ï¼Œå åœ°æ›´å°ï¼Œé€‚é…å¤šç§ä¾›æ°´åœºæ™¯ã€‚",
                    en: "Smart boosting with energy savings, quiet operation, and compact footprint for versatile water supply needs."
                },
                duration: "1 week",
                students: 1123,
                rating: 4.7,
                image: "https://i.stardots.io/armstrong/Booster.png",
                category: "Plumbing"
            },
            {
                id: 8,
                title: {
                    zh: "æ¿å¼æ¢çƒ­å™¨ç³»ç»Ÿï¼ˆPFXï¼‰",
                    en: "Plate Heat Exchanger (PFX)"
                },
                description: {
                    zh: "ä»¥è¶…è‡´å¯†æ»¡å’Œé«˜æ•ˆæ¢çƒ­ï¼Œé‡Šæ”¾æ¯ä¸€å¯¸æœºæˆ¿ç©ºé—´ï¼Œé€‚ç”¨äºå¯¹èŠ‚èƒ½å’Œä½“ç§¯è¦æ±‚æé«˜çš„æ¥¼å®‡é¡¹ç›®",
                    en: "Ultra-compact and energy-efficient heat transfer that frees up valuable mechanical room spaceâ€”perfect for energy-conscious buildings."
                },
                duration: "1 week",
                students: 892,
                rating: 4.8,
                image: "https://i.stardots.io/armstrong/PFX.png",
                category: "Heat Exchange"
            }
        ];

        // Translations
        const translations = {
            en: {
                title: "Training Courses",
                searchPlaceholder: "Search courses...",
                allCategories: "All Categories",
                students: "students",
                noResults: "No courses found matching your criteria.",
                weeks: "weeks"
            },
            zh: {
                title: "åŸ¹è®­è¯¾ç¨‹",
                searchPlaceholder: "æœç´¢è¯¾ç¨‹...",
                allCategories: "æ‰€æœ‰ç±»åˆ«",
                students: "å­¦ç”Ÿ",
                noResults: "æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„è¯¾ç¨‹ã€‚",
                weeks: "å‘¨"
            }
        };

        // Current state
        let currentLanguage = 'zh';
        // let isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches;

        //let isDarkMode = true; // âœ… å¼ºåˆ¶é»˜è®¤æš—è‰²æ¨¡å¼
        let isDarkMode = false;  // âœ… é»˜è®¤äº®è‰²

        // Initialize dark mode
        function initTheme() {
            document.documentElement.classList.toggle('dark', isDarkMode);
        }

    // Create course card
    // åœ¨åˆ›å»ºè¯¾ç¨‹å¡ç‰‡çš„å‡½æ•°å†…æ¸²æŸ“æ ‡ç­¾
function createCourseCard(course) {
  console.log("ğŸ“¦ æ¸²æŸ“è¯¾ç¨‹ï¼š", course.title.zh, "â¡ï¸ è·³è½¬ï¼š", course.link);

  return `
    <a href="${course.link || '#'}" class="block group">
      <div class="course-card bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-2xl shadow-md overflow-hidden flex flex-col">
          
          <!-- âœ… ä¸ŠåŠéƒ¨åˆ†ï¼šå›¾ç‰‡åŒºåŸŸ -->
          <div class="h-1/2 bg-gray-100 dark:bg-gray-900 flex items-center justify-center">
            <img 
                src="${course.image}" 
                alt="${course.title[currentLanguage]}" 
                class="course-image w-full h-full object-contain p-4"
            />
          </div>

          <!-- âœ… ä¸‹åŠéƒ¨åˆ†ï¼šæ–‡å­—åŒºåŸŸ -->
          <div class="h-1/2 relative overflow-hidden">
            <!-- âœ… ç¼©æ”¾å®¹å™¨ï¼šä¿æŒå›ºå®šå°ºå¯¸ -->
            <div class="scale-inner absolute inset-0 origin-top-left transition-transform duration-300 px-4">
                
              <!-- âœ… å†…éƒ¨å®é™…å†…å®¹åŒºåŸŸ -->
              <div class="inner-padding flex flex-col justify-between h-full">
                <div>
                  <!-- âœ… æ ‡ç­¾ï¼šå°å­—ä½“ + èƒ¶å›Šå½¢çŠ¶ + è‡ªé€‚åº”ç¼©æ”¾ -->
                  <span class="tag-capsule mb-1">
                    ${course.category}
                  </span>

                  <!-- æ ‡é¢˜ï¼šåŠ ç²—ï¼Œè‡ªåŠ¨æ¢è¡Œ -->
                  <h3 class="text-sm font-semibold leading-snug text-gray-900 dark:text-white break-words">
                    ${course.title[currentLanguage]}
                  </h3>

                  <!-- ç®€ä»‹ï¼šè¾ƒå°å­—ä½“ã€è‡ªåŠ¨æ¢è¡Œ -->
                  <p class="text-[0.65rem] text-gray-600 dark:text-gray-300 mt-1 break-words">
                    ${course.description[currentLanguage]}
                  </p>
                </div>

                <!-- âœ… åº•éƒ¨ä¿¡æ¯ï¼ˆæ—¶é•¿ã€äººæ•°ã€è¯„åˆ†ï¼‰ -->
                <div class="card-footer flex items-center justify-between text-[11px] text-gray-500 dark:text-gray-400 mt-4 pb-3">
                  <div class="flex items-center gap-1">
                    <i class="fas fa-clock w-3.5 h-3.5"></i><span>${course.duration}</span>
                  </div>
                  <div class="flex items-center gap-1">
                    <i class="fas fa-users w-3.5 h-3.5"></i><span>${course.students.toLocaleString()} students</span>
                  </div>
                  <div class="flex items-center gap-1">
                    <i class="fas fa-star w-3.5 h-3.5 text-yellow-400"></i><span>${course.rating}</span>
                  </div>
                </div>

              </div> <!-- inner-padding end -->
            </div> <!-- scale-inner end -->
          </div> <!-- ä¸‹åŠéƒ¨åˆ†ç»“æŸ -->
      </div> <!-- course card end -->
    </a>
  `;
}

        // Update course grid
        function updateCourseGrid() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const selectedCategory = document.getElementById('categorySelect').value;
            
            const filteredCourses = courses.filter(course => {
                const matchesSearch = 
                    course.title[currentLanguage].toLowerCase().includes(searchTerm) ||
                    course.description[currentLanguage].toLowerCase().includes(searchTerm);
                const matchesCategory = !selectedCategory || course.category === selectedCategory;
                return matchesSearch && matchesCategory;
            });

            const courseGrid = document.getElementById('courseGrid');
            const noResults = document.getElementById('noResults');

            if (filteredCourses.length === 0) {
                courseGrid.innerHTML = '';
                noResults.classList.remove('hidden');
            } else {
                courseGrid.innerHTML = filteredCourses.map(course => createCourseCard(course)).join('');
                noResults.classList.add('hidden');
            }
        }

        // Initialize category select
        function initCategories() {
            const categories = Array.from(new Set(courses.map(course => course.category)));
            const select = document.getElementById('categorySelect');
            select.innerHTML = `
                <option value="">${translations[currentLanguage].allCategories}</option>
                ${categories.map(category => `<option value="${category}">${category}</option>`).join('')}
            `;
        }

        // Update language
        function toggleLanguage() {
            currentLanguage = currentLanguage === 'en' ? 'zh' : 'en';
            document.getElementById('languageFlag').src = `https://flagcdn.com/${currentLanguage === 'en' ? 'cn' : 'us'}.svg`;
            document.getElementById('pageTitle').textContent = translations[currentLanguage].title;
            document.getElementById('searchInput').placeholder = translations[currentLanguage].searchPlaceholder;
            initCategories();
            updateCourseGrid();
            scaleCourseTextAreas(); // è¯­è¨€åˆ‡æ¢åé‡æ–°è®¡ç®—ç¼©æ”¾

            // âœ… æ›´æ–°â€œé€€å‡ºæŒ‰é’®â€æ–‡å­—
            const logoutBtn = document.getElementById("logoutBtn");
            if (logoutBtn) {
                logoutBtn.textContent = currentLanguage === 'en' ? "ï½œ Logout" : "ï½œ é€€å‡º";
            }
        }

        // Event listeners
        document.getElementById('searchInput').addEventListener('input', updateCourseGrid);
        document.getElementById('categorySelect').addEventListener('change', updateCourseGrid);
        document.getElementById('themeToggle').addEventListener('click', () => {
            isDarkMode = !isDarkMode;
            document.documentElement.classList.toggle('dark', isDarkMode);
        });
        document.getElementById('languageToggle').addEventListener('click', toggleLanguage);

        // Initialize
        initTheme();
        initCategories();
        updateCourseGrid();

        // Listen for system dark mode changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
            isDarkMode = e.matches;
            document.documentElement.classList.toggle('dark', isDarkMode);
        });
    </script>

    <!-- âœ… é¡µé¢å¿ƒè·³æœºåˆ¶è„šæœ¬ï¼ˆæ–°å¢ï¼‰ -->
    <!-- âœ… é¡µé¢åº•éƒ¨ï¼Œåœ¨ </body> æ ‡ç­¾å‰ -->
    <script>
        let lastActivityTime = Date.now();
    
        // è®°å½•äººå·¥æ“ä½œäº‹ä»¶æ—¶é—´
        const recordActivity = () => {
        lastActivityTime = Date.now();
        };
    
        // âœ… ç»‘å®šæ‰€æœ‰äººå·¥æ“ä½œäº‹ä»¶ï¼ˆç‚¹å‡»ã€æ»šåŠ¨ã€è¾“å…¥ç­‰ï¼‰
        ['mousemove', 'mousedown', 'keydown', 'scroll', 'touchstart'].forEach(evt => {
        document.addEventListener(evt, recordActivity);
        });
    
        // âœ… æ¯åˆ†é’Ÿå‘é€å¿ƒè·³è¯·æ±‚ï¼Œä»…åœ¨ç”¨æˆ·1åˆ†é’Ÿå†…æœ‰æ“ä½œæ—¶æ‰å‘é€
        setInterval(() => {
        if (Date.now() - lastActivityTime < 60000) {
            fetch('/heartbeat')
            .then(res => {
                if (res.status === 440) {
                alert("ç™»å½•å·²è¶…æ—¶ï¼Œè¯·é‡æ–°ç™»å½•ï¼");
                window.location.href = "/login";
                }
            })
            .catch(() => {});
        }
        }, 60000);
    </script>



  
<!-- âœ… ç™»å½•å¼¹çª— -->
<div id="loginOverlay" class="hidden fixed inset-0 bg-black/40 backdrop-blur-sm z-50 flex items-center justify-center">
    <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-xs shadow-xl">
      <h2 class="text-lg font-bold text-center mb-4">ä¼šè¯å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•</h2>
      <input id="reLoginUser" class="w-full mb-3 px-4 py-2 rounded-md bg-gray-100 dark:bg-gray-700" placeholder="ç”¨æˆ·å">
      <input id="reLoginPass" type="password" class="w-full mb-3 px-4 py-2 rounded-md bg-gray-100 dark:bg-gray-700" placeholder="å¯†ç ">
      <button onclick="submitRelogin()" class="w-full py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">é‡æ–°ç™»å½•</button>
    </div>
  </div>

  <!-- é¡µé¢æœ«å°¾ -->
<script>
    function showLoginOverlay() {
      document.getElementById("loginOverlay").classList.remove("hidden");
    }
    
    async function submitRelogin() {
      const username = document.getElementById("reLoginUser").value.trim();
      const password = document.getElementById("reLoginPass").value.trim();
    
      const res = await fetch("/login", {
        method: "POST",
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: new URLSearchParams({ username, password })
      });
    
      if (res.redirected) {
        location.reload();  // âœ… ç™»å½•æˆåŠŸååˆ·æ–°é¡µé¢ç»§ç»­ä½¿ç”¨
      } else {
        alert("é‡æ–°ç™»å½•å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç”¨æˆ·åæˆ–å¯†ç ");
      }
    }

    document.getElementById("reLoginPass").addEventListener("keyup", function (e) {
        if (e.key === "Enter") {
            submitRelogin();
        }
    });
    </script>

    <!-- å…³é—­ç™»å½•å¼¹çª— -->
    <script>
        function closeLoginOverlay() {
            document.getElementById("loginOverlay").classList.add("hidden");
        }
    </script>

<script>
    function scaleCourseTextAreas() {
      const cards = document.querySelectorAll('.course-card');
      cards.forEach(card => {
        const container = card.querySelector('.scale-inner');
        if (!container) return;
  
        container.style.transform = 'scale(1)'; // é‡ç½®ç¼©æ”¾
  
        const textArea = container.parentElement;
        const maxHeight = textArea.clientHeight;
        const actualHeight = container.scrollHeight;
  
        if (actualHeight > maxHeight) {
          const scale = maxHeight / actualHeight;
          container.style.transform = `scale(${scale})`;
        }
      });
    }
  
    window.addEventListener('DOMContentLoaded', scaleCourseTextAreas);
    window.addEventListener('resize', scaleCourseTextAreas);
  </script>


<script>
    // âœ… åˆ¤æ–­æ˜¯å¦ä¸ºæœ¬åœ°å¼€å‘ç¯å¢ƒ
    const isLocalhost = location.hostname === "localhost" || location.hostname === "127.0.0.1";
    
    // âœ… éæœ¬åœ°ç¯å¢ƒåˆ™å¯ç”¨è°ƒè¯•é˜²æŠ¤
    if (!isLocalhost) {
      // ç¦ç”¨å³é”®èœå•
      document.addEventListener('contextmenu', event => event.preventDefault());
    
      // ç¦ç”¨ F12ã€Ctrl+Shift+I / J / Cã€Ctrl+U ç­‰ç»„åˆé”®
      document.addEventListener('keydown', event => {
        if (
          event.key === 'F12' ||
          (event.ctrlKey && event.shiftKey && ['I', 'J', 'C'].includes(event.key.toUpperCase())) ||
          (event.ctrlKey && event.key.toUpperCase() === 'U')
        ) {
          event.preventDefault();
        }
      });
    }
    </script>

<!-- ğŸŸ¨ é¡µé¢åº•éƒ¨æ·»åŠ è„šæœ¬ï¼ˆåœ¨ </body> ä¹‹å‰ï¼‰ -->
<script>
    // æ ¹æ®è¯­è¨€åˆ‡æ¢æ›´æ–°æŒ‰é’®æ–‡å­—
    window.addEventListener('DOMContentLoaded', () => {
      const logoutBtn = document.getElementById("logoutBtn");
      if (logoutBtn) {
        logoutBtn.textContent = isChinese ? "é€€å‡º" : "Logout";
      }
    });
  
    // å¤„ç†ç™»å‡º
    function handleLogout() {
      window.location.href = "/logout";
    }
  </script>

</body>
</html>
