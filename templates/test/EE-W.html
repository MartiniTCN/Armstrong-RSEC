<!DOCTYPE html><html lang=zh-CN><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><title>EE-W 产品培训测试系统</title><script>tailwind.config={darkMode:"class"}</script><script src=https://cdn.tailwindcss.com></script><link rel=stylesheet href=/static/common/style.css><script src=https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js></script><style>tr{page-break-inside:avoid!important;break-inside:avoid!important}#completePage{width:100%;max-width:800px;margin:0 auto}@media screen and (max-width:768px){#completePage{font-size:13px}table{font-size:12px}td,th{padding:6px 4px;word-break:break-word}}#countdownCenterOverlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(255,255,255,.75);backdrop-filter:blur(6px);z-index:9999;justify-content:center;align-items:center;flex-direction:column;color:#1f2937;font-size:18px}#countdownCenterOverlay button{margin-top:1rem;padding:.5rem 1.5rem;border-radius:9999px;background:#16a34a;color:#fff;font-weight:700;border:none;cursor:pointer}</style><script src=https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js></script><script>emailjs.init("LoQCI3C98dk3FgEvj")</script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css><link rel=stylesheet href="{{ url_for('static', filename='common/style.css') }}"><script src=https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js></script><style>@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{to{transform:rotate(360deg)}}.animate-fade-in{animation:fadeIn .3s ease-out}.animate-spin{animation:spin 1s linear infinite}.option-selected{background-color:rgba(59,130,246,.1)}.page{display:none}.active-page{display:block}.option input{@apply mr-3;}.option span{color:#1f2937}.dark .option span{color:#e5e7eb}.judge-btn i{@apply text-xl opacity-0 transition-opacity;}.judge-btn input:checked~i{@apply opacity-100;}.border-red-500{border-color:rgb(239 68 68)!important}.fade-in-bounce{animation:fadeInBounce .5s ease-out}@keyframes fadeInBounce{0%{opacity:0;transform:translateY(-20px)}60%{transform:translateY(10px)}100%{opacity:1;transform:translateY(0)}}.watermark-random{position:fixed;width:220px;height:220px;background-image:url('https://i.stardots.io/armstrong/水印图片 - 金色_副本.png?width=500&rotate=0&blur=0&quality=50');background-repeat:no-repeat;background-size:contain;background-position:center;opacity:.2;z-index:0;pointer-events:none}.blur-overlay{filter:blur(5px);pointer-events:none;user-select:none;transition:all .3s ease}#examStatusBar{position:fixed;top:18px;left:50%;transform:translateX(-50%);background-color:#dc2626;color:#fff;padding:.3rem 1rem;border-radius:9999px;display:flex;justify-content:center;align-items:center;gap:1rem;font-size:.875rem;font-weight:600;z-index:9999;box-shadow:0 4px 10px rgba(0,0,0,.2);height:auto;line-height:1}#examStatusBar button{background-color:#fff;color:#dc2626;font-weight:600;padding:.2rem .75rem;border-radius:9999px;font-size:.75rem;line-height:1;transition:all .2s ease}#examStatusBar button:hover{background-color:#fef2f2}@media (max-width:640px){#examStatusBar{top:50%!important;left:auto!important;right:.5rem!important;transform:translateY(-50%);flex-direction:column;padding:.5rem .8rem;font-size:.75rem;gap:.5rem;border-radius:1rem;background-color:#dc2626;box-shadow:0 0 10px rgba(0,0,0,.3);z-index:9999}#examStatusBar button{padding:.3rem .75rem;font-size:.75rem}#examStatusBar button span{display:inline}}</style></head><body class="bg-gray-50 dark:bg-gray-900 transition-colors duration-300"><div class=page-container><div id=loading class="fixed inset-0 bg-black/50 z-50 hidden"><div class="flex items-center justify-center h-full"><div class="bg-white dark:bg-gray-800 p-6 rounded-lg flex items-center"><i class="fas fa-spinner animate-spin text-2xl text-blue-500 mr-3"></i> <span class="text-gray-700 dark:text-gray-200">正在生成报告...</span></div></div></div><nav id=mainNavbar class="card sticky top-2 mx-auto max-w-7xl z-40"><div class="flex flex-col px-2 py-1 sm:px-4 sm:py-2 gap-1"><div class="flex justify-center items-center gap-2"><img src="https://i.stardots.io/armstrong/Armstrong%20Logo%20-%20Martin.png?width=500" alt=Logo class="h-5 sm:h-8 w-auto"> <span class="text-gray-400 text-xs sm:text-base">｜</span><h1 id=pageTitle class="text-xs sm:text-base font-semibold text-gray-800 dark:text-gray-200 tracking-wide">EE-W 产品培训测试系统</h1></div><div class="flex justify-between items-center mt-1 sm:mt-2 text-xs sm:text-sm text-gray-700 dark:text-gray-300"><span id=loggedInUser class=font-semibold>欢迎：Armstrong</span><div class="flex items-center gap-2 sm:gap-3"><button id=themeToggle class="h-6 w-6 sm:h-8 sm:w-8 rounded-md bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 flex items-center justify-center text-gray-800 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 transition-all" aria-label=切换明暗模式><i class="fas fa-moon text-xs sm:text-sm dark:hidden"></i> <i class="fas fa-sun text-xs sm:text-sm hidden dark:block"></i></button> <button id=langToggle onclick=toggleLanguage() class="h-6 w-6 sm:h-8 sm:w-8 rounded-md bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 flex items-center justify-center hover:bg-gray-100 dark:hover:bg-gray-700 transition-all" aria-label=切换语言><img id=languageFlag src=https://flagcdn.com/cn.svg alt=Language class="w-4 h-3 sm:w-5 sm:h-4"></button></div></div></div></nav><div id=examStatusBar class="fixed left-1/2 -translate-x-1/2 z-30 sm:flex hidden px-4 py-2 bg-red-600 text-white text-sm rounded-xl shadow-md" style=top:0><i class="fas fa-clock mr-2"></i> <span id=countdown>60:00</span> <button onclick=togglePause() id=pauseBtn class="ml-3 bg-white text-red-600 px-3 py-1 rounded-full hover:bg-red-100 text-xs sm:text-sm"><i class="fas fa-pause mr-1"></i><span>暂停</span></button></div><section id=testPage class="page active-page container mx-auto px-4 py-6"><div class="flex justify-between mb-6"><a href=/course class="text-blue-600 dark:text-blue-400 hover:underline"><i class="fas fa-arrow-left mr-2"></i>返回课程选择页</a><div id=errorMessage class="hidden mb-6 px-6 py-4 rounded-lg text-lg font-semibold text-red-700 bg-red-100 border border-red-400 shadow fade-in-bounce flex items-center gap-3"><i class="fas fa-exclamation-triangle"></i> <span id=errorText>请完善信息</span></div><div class="text-gray-600 dark:text-gray-300"><i class="fas fa-clock mr-2"></i>考试时间：60:00</div></div><div class=card><h2 class="text-xl font-semibold mb-6"><i class="fas fa-id-card mr-2 text-blue-500"></i>学员信息</h2><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label class="block text-sm font-bold mb-2 text-gray-700 !dark:text-gray-300"><span class=text-red-500>*</span> 公司名称</label> <input type=text id=company class="bg-white dark:bg-[#2a2a2a] text-gray-900 !dark:text-gray-100 border border-gray-300 !dark:border-gray-600 rounded px-3 py-2 w-full" placeholder=请输入公司全称 required></div><div><label class="block text-sm font-bold mb-2 text-gray-700 !dark:text-gray-300"><span class=text-red-500>*</span> 学员姓名</label> <input type=text id=name class="bg-white dark:bg-[#2a2a2a] text-gray-900 !dark:text-gray-100 border border-gray-300 !dark:border-gray-600 rounded px-3 py-2 w-full" placeholder=请输入真实姓名 required></div><div><label class="block text-sm font-bold mb-2 text-gray-700 !dark:text-gray-300"><span class=text-red-500>*</span> 手机号码</label> <input type=tel id=phone class="bg-white dark:bg-[#2a2a2a] text-gray-900 !dark:text-gray-100 border border-gray-300 !dark:border-gray-600 rounded px-3 py-2 w-full" placeholder=11位手机号码 pattern=[0-9]{11} required></div><div><label class="block text-sm font-bold mb-2 text-gray-700 !dark:text-gray-300"><span class=text-red-500>*</span> 邮箱地址</label> <input type=email id=email class="bg-white dark:bg-[#2a2a2a] text-gray-900 !dark:text-gray-100 border border-gray-300 !dark:border-gray-600 rounded px-3 py-2 w-full" placeholder=name@company.com pattern=[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$ required></div></div></div><div class=card><h2 class="text-xl font-semibold mb-6"><i class="fas fa-list-ol mr-2 text-blue-500"></i>单选题（每题2分，共40分）</h2><div class=space-y-6 data-section=single></div></div><div class=card><h2 class="text-xl font-semibold mb-6"><i class="fas fa-check-square mr-2 text-purple-500"></i>多选题（每题2分，共40分）</h2><div class=space-y-6 data-section=multi></div></div><div class=card><h2 class="text-xl font-semibold mb-6"><i class="fas fa-balance-scale mr-2 text-yellow-500"></i>判断题（每题1分，共20分）</h2><div class=space-y-6 data-section=judge></div></div><div class=card><h2 class="text-xl font-semibold mb-6"><i class="fas fa-keyboard mr-2 text-pink-500"></i>简答题（共1题，10分）</h2><div class=space-y-6 data-section=essay></div></div><div class="flex justify-center mt-8"><button onclick=confirmSubmitTest() class="relative inline-flex items-center justify-center px-4 py-1.5 bg-gradient-to-r from-green-500 to-emerald-600 text-white text-sm font-medium rounded-full shadow-md hover:from-emerald-500 hover:to-green-600 transform hover:scale-105 transition-all duration-300 ease-in-out group overflow-hidden"><span class="relative z-10 flex items-center"><i class="fas fa-file-export mr-2 text-white text-base"></i> 提交答卷</span><div class="absolute inset-0 bg-white opacity-10 blur-xl group-hover:opacity-20 transition-all duration-500"></div></button></div></section><section id=completePage class="page container mx-auto px-4 py-8 text-center"><div id=resultCard class="bg-white dark:bg-gray-800 rounded-xl p-8 shadow-sm max-w-4xl mx-auto text-left"><h2 class="text-2xl font-bold mb-4 text-gray-800 dark:text-gray-200 flex items-center"><i class="fas fa-clipboard-check text-green-500 mr-2"></i>答题评估结果</h2><div class="grid grid-cols-1 sm:grid-cols-2 gap-6 mb-6 text-sm sm:text-base text-gray-700 dark:text-gray-300 break-words"><div class=space-y-2><p><strong>公司名称：</strong><span id=resultCompany>-</span></p><p><strong>姓名：</strong><span id=resultName>-</span></p><p><strong>邮箱：</strong><span id=resultEmail>-</span></p><p><strong>电话：</strong><span id=resultPhone>-</span></p></div><div class="sm:text-right space-y-2"><p><strong>提交时间：</strong><span id=resultTime>-</span></p><p><strong>总得分：</strong><span id=resultScore class="text-green-600 dark:text-green-400 text-xl font-bold">-</span> / 100</p><p><strong>评定等级：</strong><span id=resultLevel class=font-semibold>-</span></p></div></div><div class=overflow-x-auto><table class="min-w-[680px] table-auto border border-gray-300 dark:border-gray-600 text-xs sm:text-sm"><thead class="bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200"><tr><th class="p-2 border w-20">题型</th><th class="p-2 border w-16">题号</th><th class="p-2 border w-1/4">你的答案</th><th class="p-2 border w-1/4">正确答案</th><th class="p-2 border w-20">得分</th></tr></thead><tbody id=resultTableBody class="text-gray-700 dark:text-gray-300"></tbody></table></div><div class="mt-6 text-center"><button onclick=onReturnToTestPage() class="mr-4 px-6 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-full shadow-md transition-all"><i class="fas fa-arrow-left mr-2"></i>返回答题页</button> <button onclick=onStartEvaluationClick() class="px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded-full shadow-md transition-all"><i class="fas fa-paper-plane mr-2"></i>开始打分</button></div></div></section><script>let remainingTime=3600,timerInterval=null,isPaused=!1,evaluationStarted=!1,emailjsReady=!1,emailSent=!1;const EMAIL_ENABLED=!1;function loadEmailJS(){return new Promise(((e,t)=>{if(window.emailjs)return emailjsReady=!0,void e();const n=document.createElement("script");n.src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js",n.async=!0,n.onload=()=>{try{emailjs.init("LoQCI3C98dk3FgEvj"),emailjsReady=!0,e()}catch(e){console.error("[EmailJS] 初始化失败",e),t(e)}},n.onerror=()=>{console.error("[EmailJS] 加载失败，可能是网络问题"),t(new Error("SDK 加载失败"))},document.head.appendChild(n)}))}function updateCountdown(){const e=String(Math.floor(remainingTime/60)).padStart(2,"0"),t=String(remainingTime%60).padStart(2,"0");document.getElementById("countdown").innerText=`${e}:${t}`}function startTimer(){timerInterval&&clearInterval(timerInterval),timerInterval=setInterval((()=>{isPaused||(remainingTime--,updateCountdown(),remainingTime<=0&&(clearInterval(timerInterval),isPaused=!0,document.getElementById("testPage").classList.add("blur-overlay"),alert("时间已到，考试结束！")))}),1e3)}function togglePause(){isPaused=!isPaused;const e=document.getElementById("testPage"),t=document.getElementById("pauseBtn");isPaused?(e.classList.add("blur-overlay"),t.innerHTML='<i class="fas fa-play mr-1"></i><span>继续</span>'):(e.classList.remove("blur-overlay"),t.innerHTML='<i class="fas fa-pause mr-1"></i><span>暂停</span>')}let hasEnteredBefore=!1;function showTestPage(){showPage("testPage"),timerInterval||startTimer(),remainingTime>0&&(isPaused=!1,document.getElementById("testPage").classList.remove("blur-overlay"),document.getElementById("pauseBtn").innerHTML='<i class="fas fa-pause mr-1"></i>暂停',hasEnteredBefore&&(document.getElementById("countdownCenterOverlay").style.display="flex"),hasEnteredBefore=!0)}function showPage(e){document.querySelectorAll(".page").forEach((e=>{e.classList.remove("active-page")})),document.getElementById(e).classList.add("active-page"),window.scrollTo(0,0),"homePage"!==e&&"completePage"!==e||(isPaused=!0,document.getElementById("testPage").classList.add("blur-overlay"))}function collectAnswers(){return{userInfo:{company:document.getElementById("company")?.value||"",name:document.getElementById("name")?.value||"",phone:document.getElementById("phone")?.value||"",email:document.getElementById("email")?.value||""},singleChoice:Array.from(document.querySelectorAll('input[type="radio"]:checked')).filter((e=>e.name.startsWith("q"))).reduce(((e,t)=>(e[t.name]=t.value,e)),{}),multipleChoice:Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).reduce(((e,t)=>{const n=t.name.replace("mq","");return e[n]||(e[n]=[]),e[n].push(t.value),e}),{}),judgment:Array.from(document.querySelectorAll('.judge-card input[type="radio"]:checked')).reduce(((e,t)=>(e[t.name]=t.value,e)),{}),essay:(()=>{const e={};return document.querySelectorAll("textarea[data-essay-id]").forEach((t=>{const n=t.dataset.essayId;e[n]=t.value.trim()})),e})()}}function renderAssessmentResult(e){const t=(new Date).toLocaleString("zh-CN",{hour12:!1});document.getElementById("resultCompany").textContent=e.userInfo.company,document.getElementById("resultName").textContent=e.userInfo.name,document.getElementById("resultEmail").textContent=e.userInfo.email,document.getElementById("resultPhone").textContent=e.userInfo.phone,document.getElementById("resultTime").textContent=t;let n=0,o=document.getElementById("resultTableBody");o.innerHTML="";const a=document.createElement("tr");a.innerHTML=`\n  <td class="border p-2">简答题</td>\n  <td class="border p-2">1</td>\n  <td class="border p-2">${e.essay.slice(0,30)}...</td>\n  <td class="border p-2 text-center text-gray-400 italic">-</td>\n  <td class="border p-2">${0===essayScore?"✘":"✔"} ${essayScore}</td>\n`,o.appendChild(a),n+=essayScore,document.getElementById("resultScore").textContent=n,document.getElementById("resultLevel").textContent=n>=80?"✅ 合格":"❌ 不合格"}async function exportResultToPDF(e="匿名用户"){const t=document.getElementById("completePage"),n=(await html2canvas(t,{scale:2,useCORS:!0})).toDataURL("image/png"),{jsPDF:o}=window.jspdf,a=new o("p","mm","a4"),l=a.internal.pageSize.getWidth(),s=a.getImageProperties(n),r=s.height*l/s.width;a.addImage(n,"PNG",0,0,l,r),a.save(`EE-W评测结果_${e}.pdf`)}function buildEmailHTMLTable(e){const t=(e,t,n,o,a)=>`\n    <tr>\n      <td>${e}</td>\n      <td>${t}</td>\n      <td>${n}</td>\n      <td>${o}</td>\n      <td>${a}</td>\n    </tr>`,n=[],o={single:["B","C","A","B","D","C","C","B","B","B","D","C","C","B","C","B","C","B","B","B","C","D","D","B","B"],multiple:[["A","B","D"],["C","D"],["A","B","C"],["A","B","D"],["A","B","C","D"],["A","B","C","D"],["A","B","C"],["A","B","C"],["A","B","C","D"],["A","B","C","D"],["A","B","D"],["A","B","D"],["A","B","C","D"],["A","B","C"],["A","B","C"],["A","B","C"],["A","B","C","D"],["A","B","C"],["A","B","C"],["A","B","C","D"]],judge:["true","false","false","true","true","false","true","true","false","true","false","true","false","true","false","true","true","false","true","false"]};for(let a=1;a<=25;a++){const l=`q${a}`,s=e.singleChoice[l]||"-",r=o.single[a-1],i=s===r?2:0;n.push(t("单选题",a,s,r,i))}for(let a=1;a<=20;a++){const l=a.toString(),s=(e.multipleChoice[l]||[]).join(", "),r=o.multiple[a-1].join(", "),i=s.split(", ").sort().join(",")===r.split(", ").sort().join(",")?1:0;n.push(t("多选题",a,s,r,i))}for(let a=1;a<=20;a++){const l=`jq${a}`,s="true"===e.judgment[l]?"✔ 正确":"false"===e.judgment[l]?"✘ 错误":"-",r="true"===o.judge[a-1]?"✔ 正确":"✘ 错误",i=e.judgment[l]===o.judge[a-1]?1:0;n.push(t("判断题",a,s,r,i))}const a=["传感器","温度","差压","数量","安装位置","通信"].filter((t=>e.essay.includes(t))).length;let l=0;return a>=5?l=35:a>=3?l=25:a>=1&&(l=10),n.push(t("简答题",1,e.essay.slice(0,20)+"...","(关键词匹配)",l)),`\n    <table border="1" cellpadding="6" cellspacing="0" style="border-collapse: collapse; width: 100%;">\n      <thead style="background-color: #f3f4f6; color: #111">\n        <tr><th>题型</th><th>题号</th><th>你的答案</th><th>正确答案</th><th>得分</th></tr>\n      </thead>\n      <tbody>${n.join("")}</tbody>\n    </table>`}function sendResultEmail(e){console.log("[调试] 邮件功能已禁用，未执行发送。")}function renderAnswersOnCompletePage(e){const t=(new Date).toLocaleString("zh-CN",{hour12:!1});document.getElementById("resultCompany").textContent=e.userInfo.company,document.getElementById("resultName").textContent=e.userInfo.name,document.getElementById("resultEmail").textContent=e.userInfo.email,document.getElementById("resultPhone").textContent=e.userInfo.phone,document.getElementById("resultTime").textContent=t;const n=document.getElementById("resultTableBody");n.innerHTML="";const o=(e,t,o)=>{const a=document.createElement("tr");a.innerHTML=`\n      <td class="border p-2">${e}</td>\n      <td class="border p-2">${t}</td>\n      <td class="border p-2">${o}</td>\n      <td class="border p-2 text-gray-400 italic">-</td>\n      <td class="border p-2 text-gray-400 italic">-</td>\n    `,n.appendChild(a)};for(let t=1;t<=25;t++){const n=`q${t}`;o("单选题",t,e.singleChoice[n]||"未答")}for(let t=1;t<=20;t++){const n=t.toString();o("多选题",t,(e.multipleChoice[n]||[]).join(", ")||"未答")}for(let t=1;t<=20;t++){const n=`jq${t}`,a=e.judgment[n];o("判断题",t,"true"===a?"✔ 正确":"false"===a?"✘ 错误":"未答")}o("简答题",1,e.essay.slice(0,50)+(e.essay.length>50?"...":""))}async function handleExport(){if(!validateForm())return void alert("请完善必填信息和答题内容后再提交！");const e=document.getElementById("loading");e?.classList.remove("hidden");try{await new Promise((e=>setTimeout(e,300)));const e=collectAnswers();showPage("completePage"),renderAssessmentResult(e),evaluationStarted=!0,setTimeout((()=>{const t=document.getElementById("completePage"),n=e.userInfo.name||"匿名";html2pdf().from(t).set({margin:[10,10,10,10],filename:`EE-W评测结果_${n}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"},pagebreak:{mode:["css","legacy"]}}).save().then((()=>{console.log("[PDF] 导出成功")})).catch((e=>{console.error("[PDF] 导出失败",e)}))}),1e3);const t=generateEmailTableHTML(e),n={company:e.userInfo.company,user_name:e.userInfo.name,phone:e.userInfo.phone,user_email:e.userInfo.email,timestamp:(new Date).toLocaleString("zh-CN",{hour12:!1}),message:"系统自动提交：EE-W产品培训答卷",table_html:t};if(window.emailjs)emailjs.init("LoQCI3C98dk3FgEvj"),emailjs.send("service_csl8frv","template_0v2mqw9",n).then((()=>console.log("[EmailJS] 邮件发送成功"))).catch((e=>{console.error("[EmailJS] 邮件失败",e),showEmailResultPopup("❌ 邮件发送失败，是否重新发送？")}));else{const e=document.createElement("script");e.src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js",e.onload=()=>{emailjs.init("LoQCI3C98dk3FgEvj"),emailjs.send("service_csl8frv","template_0v2mqw9",n).then((()=>console.log("[EmailJS] 邮件发送成功"))).catch((e=>{console.error("[EmailJS] 邮件失败",e),alert("⚠️ 邮件发送失败，请将导出的 PDF 手动发送到 RSEC 邮箱：rsec@armstrong.com"),showEmailResultPopup("❌ 邮件发送失败，是否重新发送？")}))},document.head.appendChild(e)}}catch(e){console.error("提交失败：",e),alert("提交失败，请稍后重试。\n错误信息："+e.message)}finally{e?.classList.add("hidden")}}function validateForm(){return console.warn("[调试模式] 表单验证已跳过"),!0}function promptPasswordAndSend(e){document.getElementById("passwordModal").classList.remove("hidden"),window.confirmPassword=async function(t){const n=document.getElementById("passwordInput").value.trim();showUniversalModal("动态验证码","请输入验证码以发送成绩",!0,(e=>{if("AFT2025"===e){const e=buildEmailTable();sendResultEmail(e)}else alert("验证码错误")}));const o="AFT2025"===n;await exportResultPDF(e),t&&o?await sendResultEmail(e):t&&!o?alert("❌ 动态口令错误，未发送邮件，仅导出 PDF。"):alert("✅ 已跳过邮件，仅保存本地 PDF。")}}async function exportResultPDF(e){const t=document.getElementById("completePage"),n=e.userInfo.name||"未命名";await html2pdf().from(t).set({margin:0,filename:`EE-W评测结果_${n}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}}).save()}async function sendResultEmail(e){const t=generateEmailTableHTML(e),n={company:e.userInfo.company,user_name:e.userInfo.name,phone:e.userInfo.phone,user_email:e.userInfo.email,timestamp:(new Date).toLocaleString("zh-CN",{hour12:!1}),message:"EE-W产品培训自动提交答卷",table_html:t};try{window.emailjs||await new Promise((e=>{const t=document.createElement("script");t.src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js",t.onload=e,document.head.appendChild(t)})),emailjs.init("LoQCI3C98dk3FgEvj"),await emailjs.send("service_csl8frv","template_0v2mqw9",n),alert("✅ 邮件已成功发送！")}catch(e){console.error("[EmailJS] 邮件发送失败：",e),showEmailResultPopup("❌ 邮件发送失败，是否重新发送？")}}function sendEmailWithTemplate(e,t=null,n=null){const o="service_csl8frv",a="template_0v2mqw9",l="LoQCI3C98dk3FgEvj";if("undefined"==typeof emailjs){const s=document.createElement("script");s.src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js",s.onload=()=>{emailjs.init(l),emailjs.send(o,a,e).then((()=>{console.log("[EmailJS] 邮件发送成功"),alert("✅ 评测结果已成功发送至 RSEC 邮箱！"),"function"==typeof t&&t()})).catch((e=>{console.error("[EmailJS] 邮件发送失败:",e),showEmailResultPopup("❌ 邮件发送失败，是否重新发送？"),"function"==typeof n&&n(e)}))},s.onerror=()=>{console.error("[EmailJS] 模块加载失败"),"function"==typeof n&&n(new Error("模块加载失败"))},document.head.appendChild(s)}else emailjs.init(l),emailjs.send(o,a,e).then((()=>{console.log("[EmailJS] 邮件发送成功"),alert("✅ 评测结果已成功发送至 RSEC 邮箱！"),"function"==typeof t&&t()})).catch((e=>{console.error("[EmailJS] 邮件发送失败:",e),showEmailResultPopup("❌ 邮件发送失败，是否重新发送？"),"function"==typeof n&&n(e)}))}function generateEmailTableHTML(e){let t=`\n  <style>\n    table { border-collapse: collapse; width: 100%; margin-bottom: 20px; font-family: sans-serif; font-size: 14px; }\n    th, td { border: 1px solid #ccc; padding: 6px 10px; text-align: center; }\n    thead { background-color: #f3f4f6; color: #111827; }\n    .title { background-color: #ef4444; color: white; font-weight: bold; }\n  </style>\n\n  <h2 style="margin-top: 0;">📋 答题评估结果</h2>\n  <p><strong>公司名称：</strong>${e.userInfo.company}</p>\n  <p><strong>姓名：</strong>${e.userInfo.name}</p>\n  <p><strong>邮箱：</strong>${e.userInfo.email}</p>\n  <p><strong>电话：</strong>${e.userInfo.phone}</p>\n  <p><strong>提交时间：</strong>${(new Date).toLocaleString("zh-CN",{hour12:!1})}</p>\n  `;const n={single:["B","C","A","B","D","C","C","B","B","B","D","C","C","B","C","B","C","B","B","B","C","D","D","B","B"],multiple:[["A","B","D"],["C","D"],["A","B","C"],["A","B","D"],["A","B","C","D"],["A","B","C","D"],["A","B","C"],["A","B","C"],["A","B","C","D"],["A","B","C","D"],["A","B","D"],["A","B","D"],["A","B","C","D"],["A","B","C"],["A","B","C"],["A","B","C"],["A","B","C","D"],["A","B","C"],["A","B","C"],["A","B","C","D"]],judge:["true","false","false","true","true","false","true","true","false","true","false","true","false","true","false","true","true","false","true","false"]},o=(e,n,o,a,l)=>{let s="";for(let t=1;t<=n;t++){s+=`<tr>\n        <td>${e}</td>\n        <td>${t}</td>\n        <td>${o(t)}</td>\n        <td>${a(t)}</td>\n        <td>${l(t)}</td>\n      </tr>`}t+=`\n      <table>\n        <thead class="title"><tr><th colspan="5">${e}</th></tr></thead>\n        <thead><tr><th>题型</th><th>题号</th><th>你的答案</th><th>正确答案</th><th>得分</th></tr></thead>\n        <tbody>${s}</tbody>\n      </table>`};o("单选题",25,(t=>e.singleChoice[`q${t}`]||"未答"),(e=>n.single[e-1]),(t=>e.singleChoice[`q${t}`]===n.single[t-1]?2:0)),o("多选题",20,(t=>(e.multipleChoice[t]||[]).join(", ")||"未答"),(e=>n.multiple[e-1].join(", ")),(t=>{const o=(e.multipleChoice[t]||[]).sort(),a=n.multiple[t-1].sort();return JSON.stringify(o)===JSON.stringify(a)?1:0})),o("判断题",20,(t=>{const n=e.judgment[`jq${t}`];return"true"===n?"✔ 正确":"false"===n?"✘ 错误":"未答"}),(e=>"true"===n.judge[e-1]?"✔ 正确":"✘ 错误"),(t=>e.judgment[`jq${t}`]===n.judge[t-1]?1:0));const a=e.essay||"",l=["传感器","温度","差压","数量","安装位置","通信"].filter((e=>a.includes(e))).length;return t+=`\n    <table>\n      <thead class="title"><tr><th colspan="5">简答题</th></tr></thead>\n      <tbody><tr><td colspan="5" style="text-align: left;">${a||"未作答"}<br/><strong>得分：</strong>${l>=5?35:l>=3?25:l>=1?10:0}（匹配关键词：${l}）</td></tr></tbody>\n    </table>`,t}async function handleScreenshotAndEmail(){try{const e=collectAnswers(),t=e.userInfo.name||"匿名用户",n=document.getElementById("completePage");await html2pdf().from(n).set({margin:0,filename:`EE-W评测结果_${t}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}}).save();const o=generateEmailTableHTML(e),a={company:e.userInfo.company,user_name:t,phone:e.userInfo.phone,user_email:e.userInfo.email,timestamp:(new Date).toLocaleString("zh-CN",{hour12:!1}),message:"系统自动提交：EE-W产品培训答卷（手动触发）",table_html:o};emailjs.send("service_csl8frv","template_0v2mqw9",a).then((()=>alert("✅ 邮件已成功发送！"))).catch((e=>{console.error("[EmailJS] 邮件发送失败：",e),showEmailResultPopup("❌ 邮件发送失败，是否重新发送？")}))}catch(e){console.error("[发送错误]：",e),alert("❌ 出现错误，无法完成操作，请稍后重试！")}}function confirmStartEvaluation(){if(confirm("您确定开始进行评测吗？\n提交后将自动推送给 Armstrong RSEC 部门，并导出 PDF。")){const e=sessionStorage.getItem("userAnswers");if(!e)return void alert("⚠️ 无法获取答题数据，请重新提交！");const t=JSON.parse(e);sessionStorage.setItem("hasEvaluated","true"),promptPasswordAndSend(t)}else alert("已取消评测，您可继续检查答题内容。")}function returnToTestPage(){"true"!==sessionStorage.getItem("hasEvaluated")?(showPage("testPage"),document.querySelectorAll('input[type="radio"]:checked, input[type="checkbox"]:checked').forEach((e=>e.checked=!1)),document.getElementById("essay").value="",window.scrollTo(0,0)):alert("⚠️ 您已完成评测，带有完成时间的结果已经发送出去，无法返回修改答卷！")}function startEvaluationPrompt(){confirm("您确定要开始进行评测吗？\n评测后将自动导出 PDF，并发送结果至 Armstrong RSEC。")?promptPasswordAndSend():alert("已取消评测操作。您仍可检查答题内容。")}function onStartEvaluationClick(){confirm("您确定开始进行评测吗？\n\n一旦开始，将无法返回测试页，并会导出 PDF、推送结果到 Armstrong RSEC。")&&promptPasswordAndSend()}function promptPasswordAndSend(){const e=prompt("请输入动态口令（如由 RSEC 部门提供）：");if(!e)return alert("未输入验证码，操作已取消。");if("AFT2025"===e){const e=collectAnswers();renderAssessmentResult(e),exportPDF(e),sendEmailResult(e),evaluationStarted=!0}else{const e=collectAnswers();evaluationStarted=!0,renderAssessmentResult(e),exportPDF(e),alert("动态验证码错误，仅导出 PDF，未发送邮件，请联系管理员。")}}function exportPDF(e){const t=e.userInfo.name||"匿名用户",n=document.getElementById("completePage");html2pdf().from(n).set({margin:[10,10,10,10],filename:`EE-W评测结果_${t}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0,scrollX:0,scrollY:0,windowWidth:n.scrollWidth,windowHeight:n.scrollHeight},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}}).save()}function sendEmailResult(e){const t=generateEmailTableHTML(e),n={company:e.userInfo.company,user_name:e.userInfo.name,phone:e.userInfo.phone,user_email:e.userInfo.email,timestamp:(new Date).toLocaleString("zh-CN",{hour12:!1}),message:"系统自动提交：EE-W产品培训答卷",table_html:t};emailjs.send("service_csl8frv","template_0v2mqw9",n).then((()=>{console.log("✅ 邮件发送成功"),alert("✅ 评测结果已成功发送至 RSEC 邮箱！")})).catch((e=>{console.error("[EmailJS] 邮件失败",e),showEmailResultPopup("❌ 邮件发送失败，是否重新发送？")}))}function onReturnToTestPage(){if(evaluationStarted)return void alert("⚠️ 评测已开始，无法返回答题页！");const e=collectAnswers();showPage("testPage"),document.getElementById("company").value=e.userInfo.company,document.getElementById("name").value=e.userInfo.name,document.getElementById("email").value=e.userInfo.email,document.getElementById("phone").value=e.userInfo.phone}function showRetryModal(){document.getElementById("emailRetryModal").classList.remove("hidden")}function closeRetryModal(){document.getElementById("emailRetryModal").classList.add("hidden")}console.log("绑定 retryEmailBtn...");const btn=document.getElementById("retryEmailBtn");function reinitializeEmailJS(){if(window.emailjs)try{emailjs.init("LoQCI3C98dk3FgEvj"),console.log("✅ EmailJS 已重新初始化")}catch(e){console.error("❌ EmailJS 初始化失败",e)}else console.error("⚠️ EmailJS 模块未加载")}function retryEmailSend(){hideEmailResultPopup(),reinitializeEmailJS(),setTimeout((()=>{handleExportWithPDFAndEmail()}),200)}function showEmailResultPopup(e){const t=`\n    <div id="emailResultPopup" class="fixed inset-0 bg-black bg-opacity-50 z-[9999] flex items-center justify-center">\n      <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 w-[300px] text-center fade-in-bounce">\n        <p class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4">${e}</p>\n        <div class="flex justify-center gap-4">\n          <button id="retrySendBtn" class="bg-blue-600 text-white px-4 py-1.5 rounded hover:bg-blue-700">是</button>\n          <button id="cancelSendBtn" class="bg-gray-300 text-gray-800 px-4 py-1.5 rounded hover:bg-gray-400">否</button>\n        </div>\n      </div>\n    </div>\n  `;document.body.insertAdjacentHTML("beforeend",t),document.getElementById("retrySendBtn").onclick=()=>{document.getElementById("emailResultPopup").remove(),emailjs.init("LoQCI3C98dk3FgEvj");try{handleExportWithPDFAndEmail(!0)}catch(e){alert("邮件再次发送失败，请稍后再试。")}},document.getElementById("cancelSendBtn").onclick=()=>{document.getElementById("emailResultPopup").remove()}}console.log("retryEmailBtn =",btn),btn?btn.addEventListener("click",(()=>{if(closeRetryModal(),window.emailjs)try{emailjs.init("LoQCI3C98dk3FgEvj")}catch(e){console.error("EmailJS 初始化失败",e)}handleEmailSendAgain()})):console.warn("⚠️ 没有找到 #retryEmailBtn，跳过绑定")</script><script>document.addEventListener("DOMContentLoaded",(()=>{for(let e=0;e<30;e++){const e=document.createElement("div");e.className="watermark-random",e.style.top=120*Math.random()-10+"vh",e.style.left=120*Math.random()-10+"vw",e.style.transform=`rotate(30deg) scale(${.7+.6*Math.random()})`,document.body.appendChild(e)}}))</script><div id=passwordModal class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center"><div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md w-full max-w-sm text-center"><h3 class="text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4">请输入动态口令以发送评测结果至邮箱</h3><input id=passwordInput type=password placeholder=请输入口令... class="w-full p-2 border rounded-md mb-4 focus:outline-none focus:ring focus:border-blue-300"><div class="flex justify-between space-x-4"><button onclick=confirmPassword(!0) class="flex-1 bg-green-600 hover:bg-green-700 text-white py-2 rounded">确定</button> <button onclick=confirmPassword(!1) class="flex-1 bg-gray-400 hover:bg-gray-500 text-white py-2 rounded">跳过发送</button></div></div></div><div id=countdownCenterOverlay class="hidden fixed inset-0 flex"><div class=text-center><p>当前考试已暂停</p><p>点击下方按钮可恢复考试</p><button onclick=resumeFromCenterOverlay()>继续答题</button></div></div><script>document.addEventListener("DOMContentLoaded",(function(){startTimer()}))</script><div id=emailRetryModal class="fixed inset-0 z-50 hidden bg-black bg-opacity-50 flex items-center justify-center"><div class="bg-white dark:bg-gray-800 rounded-xl p-6 w-80 text-center shadow-lg"><p class="text-lg font-semibold text-gray-900 dark:text-white mb-4">邮件发送失败，是否重试？</p><div class="flex justify-center gap-4"><button id=retryEmailBtn onclick=retryEmailSend() class="bg-green-500 hover:bg-green-600 ...">是，重新发送</button> <button id=retryEmailBtn onclick=hideEmailResultPopup() class="bg-gray-400 hover:bg-gray-500 ...">否，暂不发送</button></div></div></div><script src=https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js></script><script>if(void 0===currentLang)var currentLang="zh";function loadQuestionsFromCSV(t){Papa.parse(t,{download:!0,header:!0,complete:function(t){const n=t.data.filter((t=>"简答题"===t["题型"]));if(n.length>0){const t=n[0],e=document.querySelector("#short1");if(e){const n="en"===currentLang?t["English Question"]:t["中文题干"];e.querySelector("h3").textContent=n}}}})}function switchLanguage(t){currentLang=t,loadQuestionsFromCSV("/static/csv/EE-W.csv")}window.addEventListener("DOMContentLoaded",(()=>{loadQuestionsFromCSV("/static/csv/EE-W.csv")}))</script><script src=https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js></script><script>if(void 0===currentLang)var currentLang="zh";document.addEventListener("DOMContentLoaded",(function(){Papa.parse("/static/csv/EE-W.csv",{download:!0,header:!0,complete:function(e){const n=e.data;n.filter((e=>"单选题"===e["题型"])).forEach(((e,n)=>{const t=n+1,r=document.querySelector(`#q${t}`);if(!r)return;const o="en"===currentLang?e["English Question"]:e["中文题干"],c=r.querySelector("h3");c&&(c.textContent=`${t}. ${o}`),["A","B","C","D"].forEach((n=>{const o=r.querySelector(`label[for="q${t}-${n}"]`),c="en"===currentLang?e[n+"_EN"]:e[n];o&&c&&(o.innerHTML=`<input type="radio" id="q${t}-${n}" name="q${t}" value="${n}"> ${n}. ${c}`)}))})),n.filter((e=>"多选题"===e["题型"])).forEach(((e,n)=>{const t=n+1,r=document.querySelector(`#multi${t}`);if(!r)return;const o="en"===currentLang?e["English Question"]:e["中文题干"],c=r.querySelector("h3");c&&(c.textContent=`${t}. ${o}`),["A","B","C","D","E","F"].forEach((n=>{const o=r.querySelector(`label[for="m${t}-${n}"]`),c="en"===currentLang?e[n+"_EN"]:e[n];o&&c&&(o.innerHTML=`<input type="checkbox" id="m${t}-${n}" name="multi${t}" value="${n}"> ${n}. ${c}`)}))})),n.filter((e=>"判断题"===e["题型"])).forEach(((e,n)=>{const t=n+1,r=document.querySelector(`#jq${t}`);if(!r)return;const o="en"===currentLang?e["English Question"]:e["中文题干"],c=r.querySelector("h3");c&&(c.textContent=`${t}. ${o}`)}));const t=n.find((e=>"简答题"===e["题型"])),r=document.querySelector("#short1");if(t&&r){const e="en"===currentLang?t["English Question"]:t["中文题干"],n=r.querySelector("h3");n&&(n.textContent=e)}},error:function(e){console.error("❌ 题库加载失败：",e)}})}))</script><script>let lastActivityTime=Date.now();const recordActivity=()=>{lastActivityTime=Date.now()};["mousemove","mousedown","keydown","scroll","touchstart"].forEach((t=>{document.addEventListener(t,recordActivity)})),setInterval((()=>{Date.now()-lastActivityTime<6e4&&fetch("/heartbeat").then((t=>{440===t.status&&(alert("登录已超时，请重新登录！"),window.location.href="/login")})).catch((()=>{}))}),6e4)</script><div id=loginOverlay class="hidden fixed inset-0 bg-black/40 backdrop-blur-sm z-50 flex items-center justify-center"><div class="bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-xs shadow-xl"><h2 class="text-lg font-bold text-center mb-4">会话已过期，请重新登录</h2><input id=reLoginUser class="w-full mb-3 px-4 py-2 rounded-md bg-gray-100 dark:bg-gray-700" placeholder=用户名> <input id=reLoginPass type=password class="w-full mb-3 px-4 py-2 rounded-md bg-gray-100 dark:bg-gray-700" placeholder=密码> <button onclick=submitRelogin() class="w-full py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">重新登录</button></div></div><script>function showLoginOverlay(){document.getElementById("loginOverlay").classList.remove("hidden")}async function submitRelogin(){const e=document.getElementById("reLoginUser").value.trim(),n=document.getElementById("reLoginPass").value.trim();(await fetch("/login",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({username:e,password:n})})).redirected?location.reload():alert("重新登录失败，请检查用户名或密码")}document.getElementById("reLoginPass").addEventListener("keyup",(function(e){"Enter"===e.key&&submitRelogin()}))</script><script>function closeLoginOverlay(){document.getElementById("loginOverlay").classList.add("hidden")}</script><script src=https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js></script><script>if(void 0===currentLang)var currentLang="zh";document.addEventListener("DOMContentLoaded",(function(){Papa.parse("/static/csv/EE-W.csv",{download:!0,header:!0,complete:function(e){const n=e.data;n.filter((e=>"单选题"===e["题型"])).forEach(((e,n)=>{const t=n+1,r=document.querySelector(`#q${t}`);if(!r)return;const o="en"===currentLang?e["English Question"]:e["中文题干"],c=r.querySelector("h3");c&&(c.textContent=`${t}. ${o}`),["A","B","C","D"].forEach((n=>{const o=r.querySelector(`label[for="q${t}-${n}"]`),c="en"===currentLang?e[n+"_EN"]:e[n];o&&c&&(o.innerHTML=`<input type="radio" id="q${t}-${n}" name="q${t}" value="${n}"> ${n}. ${c}`)}))})),n.filter((e=>"多选题"===e["题型"])).forEach(((e,n)=>{const t=n+1,r=document.querySelector(`#multi${t}`);if(!r)return;const o="en"===currentLang?e["English Question"]:e["中文题干"],c=r.querySelector("h3");c&&(c.textContent=`${t}. ${o}`),["A","B","C","D","E","F"].forEach((n=>{const o=r.querySelector(`label[for="m${t}-${n}"]`),c="en"===currentLang?e[n+"_EN"]:e[n];o&&c&&(o.innerHTML=`<input type="checkbox" id="m${t}-${n}" name="multi${t}" value="${n}"> ${n}. ${c}`)}))})),n.filter((e=>"判断题"===e["题型"])).forEach(((e,n)=>{const t=n+1,r=document.querySelector(`#jq${t}`);if(!r)return;const o="en"===currentLang?e["English Question"]:e["中文题干"],c=r.querySelector("h3");c&&(c.textContent=`${t}. ${o}`)}));const t=n.find((e=>"简答题"===e["题型"])),r=document.querySelector("#short1");if(t&&r){const e="en"===currentLang?t["English Question"]:t["中文题干"],n=r.querySelector("h3");n&&(n.textContent=e)}},error:function(e){console.error("❌ 题库加载失败：",e)}})}))</script><script src=/static/common/render.js></script><script>document.addEventListener("DOMContentLoaded",(function(){loadCSVAndRender("/static/csv/EE-W.csv","zh")}))</script><div id=universalModal class="fixed z-50 inset-0 overflow-y-auto bg-gray-800 bg-opacity-50 flex items-center justify-center hidden"><div class="bg-white dark:bg-gray-900 p-6 rounded-lg shadow-lg w-full max-w-md text-center"><h2 id=modalTitle class="text-xl font-semibold mb-4 text-gray-800 dark:text-gray-100">提示标题</h2><p id=modalMessage class="text-gray-700 dark:text-gray-300 mb-6">提示内容文本，可根据实际内容动态设置</p><input id=modalInput class="bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 border border-gray-300 dark:border-gray-600 rounded p-2 w-full mb-4 hidden" type=text placeholder=请输入内容><div class="flex justify-end gap-4"><button id=modalConfirmBtn class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded">确定</button> <button onclick=closeUniversalModal() class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded">取消</button></div></div></div><script>window.addEventListener("DOMContentLoaded",(()=>{const e=document.documentElement,t=document.getElementById("themeToggle"),s=localStorage.getItem("theme");if("dark"===s)e.classList.add("dark"),console.log("[Init] 恢复为 dark 模式");else if("light"===s)e.classList.remove("dark"),console.log("[Init] 恢复为 light 模式");else{const t=window.matchMedia("(prefers-color-scheme: dark)").matches;e.classList.toggle("dark",t),localStorage.setItem("theme",t?"dark":"light")}t&&t.addEventListener("click",(()=>{const t=e.classList.contains("dark");e.classList.toggle("dark"),localStorage.setItem("theme",t?"light":"dark")}))}))</script><script>function positionCountdownBar(){const n=document.getElementById("mainNavbar"),t=document.getElementById("examStatusBar");if(n&&t){const o=n.getBoundingClientRect(),e=window.scrollY||window.pageYOffset,d=o.bottom+e;t.style.top=`${d+0}px`}}window.addEventListener("DOMContentLoaded",positionCountdownBar),window.addEventListener("resize",positionCountdownBar)</script></div><script>const isLocalhost="localhost"===location.hostname||"127.0.0.1"===location.hostname;isLocalhost||(document.addEventListener("contextmenu",(e=>e.preventDefault())),document.addEventListener("keydown",(e=>{("F12"===e.key||e.ctrlKey&&e.shiftKey&&["I","J","C"].includes(e.key.toUpperCase())||e.ctrlKey&&"U"===e.key.toUpperCase())&&e.preventDefault()})))</script></body></html>