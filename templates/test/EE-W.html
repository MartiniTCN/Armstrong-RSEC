<!DOCTYPE html><html lang=zh-CN><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><title>EE-W äº§å“åŸ¹è®­æµ‹è¯•ç³»ç»Ÿ</title><script>tailwind.config={darkMode:"class"}</script><script src=https://cdn.tailwindcss.com></script><link rel=stylesheet href=/static/common/style.css><script src=https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js></script><style>tr{page-break-inside:avoid!important;break-inside:avoid!important}#completePage{width:100%;max-width:800px;margin:0 auto}@media screen and (max-width:768px){#completePage{font-size:13px}table{font-size:12px}td,th{padding:6px 4px;word-break:break-word}}#countdownCenterOverlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(255,255,255,.75);backdrop-filter:blur(6px);z-index:9999;justify-content:center;align-items:center;flex-direction:column;color:#1f2937;font-size:18px}#countdownCenterOverlay button{margin-top:1rem;padding:.5rem 1.5rem;border-radius:9999px;background:#16a34a;color:#fff;font-weight:700;border:none;cursor:pointer}</style><script src=https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js></script><script>emailjs.init("LoQCI3C98dk3FgEvj")</script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css><link rel=stylesheet href="{{ url_for('static', filename='common/style.css') }}"><script src=https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js></script><style>@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{to{transform:rotate(360deg)}}.animate-fade-in{animation:fadeIn .3s ease-out}.animate-spin{animation:spin 1s linear infinite}.option-selected{background-color:rgba(59,130,246,.1)}.page{display:none}.active-page{display:block}.option input{@apply mr-3;}.option span{color:#1f2937}.dark .option span{color:#e5e7eb}.judge-btn i{@apply text-xl opacity-0 transition-opacity;}.judge-btn input:checked~i{@apply opacity-100;}.border-red-500{border-color:rgb(239 68 68)!important}.fade-in-bounce{animation:fadeInBounce .5s ease-out}@keyframes fadeInBounce{0%{opacity:0;transform:translateY(-20px)}60%{transform:translateY(10px)}100%{opacity:1;transform:translateY(0)}}.watermark-random{position:fixed;width:220px;height:220px;background-image:url('https://i.stardots.io/armstrong/æ°´å°å›¾ç‰‡ - é‡‘è‰²_å‰¯æœ¬.png?width=500&rotate=0&blur=0&quality=50');background-repeat:no-repeat;background-size:contain;background-position:center;opacity:.2;z-index:0;pointer-events:none}.blur-overlay{filter:blur(5px);pointer-events:none;user-select:none;transition:all .3s ease}#examStatusBar{position:fixed;top:18px;left:50%;transform:translateX(-50%);background-color:#dc2626;color:#fff;padding:.3rem 1rem;border-radius:9999px;display:flex;justify-content:center;align-items:center;gap:1rem;font-size:.875rem;font-weight:600;z-index:9999;box-shadow:0 4px 10px rgba(0,0,0,.2);height:auto;line-height:1}#examStatusBar button{background-color:#fff;color:#dc2626;font-weight:600;padding:.2rem .75rem;border-radius:9999px;font-size:.75rem;line-height:1;transition:all .2s ease}#examStatusBar button:hover{background-color:#fef2f2}@media (max-width:640px){#examStatusBar{top:50%!important;left:auto!important;right:.5rem!important;transform:translateY(-50%);flex-direction:column;padding:.5rem .8rem;font-size:.75rem;gap:.5rem;border-radius:1rem;background-color:#dc2626;box-shadow:0 0 10px rgba(0,0,0,.3);z-index:9999}#examStatusBar button{padding:.3rem .75rem;font-size:.75rem}#examStatusBar button span{display:inline}}</style></head><body class="bg-gray-50 dark:bg-gray-900 transition-colors duration-300"><div class=page-container><div id=loading class="fixed inset-0 bg-black/50 z-50 hidden"><div class="flex items-center justify-center h-full"><div class="bg-white dark:bg-gray-800 p-6 rounded-lg flex items-center"><i class="fas fa-spinner animate-spin text-2xl text-blue-500 mr-3"></i> <span class="text-gray-700 dark:text-gray-200">æ­£åœ¨ç”ŸæˆæŠ¥å‘Š...</span></div></div></div><nav id=mainNavbar class="card sticky top-2 mx-auto max-w-7xl z-40"><div class="flex flex-col px-2 py-1 sm:px-4 sm:py-2 gap-1"><div class="flex justify-center items-center gap-2"><img src="https://i.stardots.io/armstrong/Armstrong%20Logo%20-%20Martin.png?width=500" alt=Logo class="h-5 sm:h-8 w-auto"> <span class="text-gray-400 text-xs sm:text-base">ï½œ</span><h1 id=pageTitle class="text-xs sm:text-base font-semibold text-gray-800 dark:text-gray-200 tracking-wide">EE-W äº§å“åŸ¹è®­æµ‹è¯•ç³»ç»Ÿ</h1></div><div class="flex justify-between items-center mt-1 sm:mt-2 text-xs sm:text-sm text-gray-700 dark:text-gray-300"><span id=loggedInUser class=font-semibold>æ¬¢è¿ï¼šArmstrong</span><div class="flex items-center gap-2 sm:gap-3"><button id=themeToggle class="h-6 w-6 sm:h-8 sm:w-8 rounded-md bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 flex items-center justify-center text-gray-800 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 transition-all" aria-label=åˆ‡æ¢æ˜æš—æ¨¡å¼><i class="fas fa-moon text-xs sm:text-sm dark:hidden"></i> <i class="fas fa-sun text-xs sm:text-sm hidden dark:block"></i></button> <button id=langToggle onclick=toggleLanguage() class="h-6 w-6 sm:h-8 sm:w-8 rounded-md bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 flex items-center justify-center hover:bg-gray-100 dark:hover:bg-gray-700 transition-all" aria-label=åˆ‡æ¢è¯­è¨€><img id=languageFlag src=https://flagcdn.com/cn.svg alt=Language class="w-4 h-3 sm:w-5 sm:h-4"></button></div></div></div></nav><div id=examStatusBar class="fixed left-1/2 -translate-x-1/2 z-30 sm:flex hidden px-4 py-2 bg-red-600 text-white text-sm rounded-xl shadow-md" style=top:0><i class="fas fa-clock mr-2"></i> <span id=countdown>60:00</span> <button onclick=togglePause() id=pauseBtn class="ml-3 bg-white text-red-600 px-3 py-1 rounded-full hover:bg-red-100 text-xs sm:text-sm"><i class="fas fa-pause mr-1"></i><span>æš‚åœ</span></button></div><section id=testPage class="page active-page container mx-auto px-4 py-6"><div class="flex justify-between mb-6"><a href=/course class="text-blue-600 dark:text-blue-400 hover:underline"><i class="fas fa-arrow-left mr-2"></i>è¿”å›è¯¾ç¨‹é€‰æ‹©é¡µ</a><div id=errorMessage class="hidden mb-6 px-6 py-4 rounded-lg text-lg font-semibold text-red-700 bg-red-100 border border-red-400 shadow fade-in-bounce flex items-center gap-3"><i class="fas fa-exclamation-triangle"></i> <span id=errorText>è¯·å®Œå–„ä¿¡æ¯</span></div><div class="text-gray-600 dark:text-gray-300"><i class="fas fa-clock mr-2"></i>è€ƒè¯•æ—¶é—´ï¼š60:00</div></div><div class=card><h2 class="text-xl font-semibold mb-6"><i class="fas fa-id-card mr-2 text-blue-500"></i>å­¦å‘˜ä¿¡æ¯</h2><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label class="block text-sm font-bold mb-2 text-gray-700 !dark:text-gray-300"><span class=text-red-500>*</span> å…¬å¸åç§°</label> <input type=text id=company class="bg-white dark:bg-[#2a2a2a] text-gray-900 !dark:text-gray-100 border border-gray-300 !dark:border-gray-600 rounded px-3 py-2 w-full" placeholder=è¯·è¾“å…¥å…¬å¸å…¨ç§° required></div><div><label class="block text-sm font-bold mb-2 text-gray-700 !dark:text-gray-300"><span class=text-red-500>*</span> å­¦å‘˜å§“å</label> <input type=text id=name class="bg-white dark:bg-[#2a2a2a] text-gray-900 !dark:text-gray-100 border border-gray-300 !dark:border-gray-600 rounded px-3 py-2 w-full" placeholder=è¯·è¾“å…¥çœŸå®å§“å required></div><div><label class="block text-sm font-bold mb-2 text-gray-700 !dark:text-gray-300"><span class=text-red-500>*</span> æ‰‹æœºå·ç </label> <input type=tel id=phone class="bg-white dark:bg-[#2a2a2a] text-gray-900 !dark:text-gray-100 border border-gray-300 !dark:border-gray-600 rounded px-3 py-2 w-full" placeholder=11ä½æ‰‹æœºå·ç  pattern=[0-9]{11} required></div><div><label class="block text-sm font-bold mb-2 text-gray-700 !dark:text-gray-300"><span class=text-red-500>*</span> é‚®ç®±åœ°å€</label> <input type=email id=email class="bg-white dark:bg-[#2a2a2a] text-gray-900 !dark:text-gray-100 border border-gray-300 !dark:border-gray-600 rounded px-3 py-2 w-full" placeholder=name@company.com pattern=[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$ required></div></div></div><div class=card><h2 class="text-xl font-semibold mb-6"><i class="fas fa-list-ol mr-2 text-blue-500"></i>å•é€‰é¢˜ï¼ˆæ¯é¢˜2åˆ†ï¼Œå…±40åˆ†ï¼‰</h2><div class=space-y-6 data-section=single></div></div><div class=card><h2 class="text-xl font-semibold mb-6"><i class="fas fa-check-square mr-2 text-purple-500"></i>å¤šé€‰é¢˜ï¼ˆæ¯é¢˜2åˆ†ï¼Œå…±40åˆ†ï¼‰</h2><div class=space-y-6 data-section=multi></div></div><div class=card><h2 class="text-xl font-semibold mb-6"><i class="fas fa-balance-scale mr-2 text-yellow-500"></i>åˆ¤æ–­é¢˜ï¼ˆæ¯é¢˜1åˆ†ï¼Œå…±20åˆ†ï¼‰</h2><div class=space-y-6 data-section=judge></div></div><div class=card><h2 class="text-xl font-semibold mb-6"><i class="fas fa-keyboard mr-2 text-pink-500"></i>ç®€ç­”é¢˜ï¼ˆå…±1é¢˜ï¼Œ10åˆ†ï¼‰</h2><div class=space-y-6 data-section=essay></div></div><div class="flex justify-center mt-8"><button onclick=confirmSubmitTest() class="relative inline-flex items-center justify-center px-4 py-1.5 bg-gradient-to-r from-green-500 to-emerald-600 text-white text-sm font-medium rounded-full shadow-md hover:from-emerald-500 hover:to-green-600 transform hover:scale-105 transition-all duration-300 ease-in-out group overflow-hidden"><span class="relative z-10 flex items-center"><i class="fas fa-file-export mr-2 text-white text-base"></i> æäº¤ç­”å·</span><div class="absolute inset-0 bg-white opacity-10 blur-xl group-hover:opacity-20 transition-all duration-500"></div></button></div></section><section id=completePage class="page container mx-auto px-4 py-8 text-center"><div id=resultCard class="bg-white dark:bg-gray-800 rounded-xl p-8 shadow-sm max-w-4xl mx-auto text-left"><h2 class="text-2xl font-bold mb-4 text-gray-800 dark:text-gray-200 flex items-center"><i class="fas fa-clipboard-check text-green-500 mr-2"></i>ç­”é¢˜è¯„ä¼°ç»“æœ</h2><div class="grid grid-cols-1 sm:grid-cols-2 gap-6 mb-6 text-sm sm:text-base text-gray-700 dark:text-gray-300 break-words"><div class=space-y-2><p><strong>å…¬å¸åç§°ï¼š</strong><span id=resultCompany>-</span></p><p><strong>å§“åï¼š</strong><span id=resultName>-</span></p><p><strong>é‚®ç®±ï¼š</strong><span id=resultEmail>-</span></p><p><strong>ç”µè¯ï¼š</strong><span id=resultPhone>-</span></p></div><div class="sm:text-right space-y-2"><p><strong>æäº¤æ—¶é—´ï¼š</strong><span id=resultTime>-</span></p><p><strong>æ€»å¾—åˆ†ï¼š</strong><span id=resultScore class="text-green-600 dark:text-green-400 text-xl font-bold">-</span> / 100</p><p><strong>è¯„å®šç­‰çº§ï¼š</strong><span id=resultLevel class=font-semibold>-</span></p></div></div><div class=overflow-x-auto><table class="min-w-[680px] table-auto border border-gray-300 dark:border-gray-600 text-xs sm:text-sm"><thead class="bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200"><tr><th class="p-2 border w-20">é¢˜å‹</th><th class="p-2 border w-16">é¢˜å·</th><th class="p-2 border w-1/4">ä½ çš„ç­”æ¡ˆ</th><th class="p-2 border w-1/4">æ­£ç¡®ç­”æ¡ˆ</th><th class="p-2 border w-20">å¾—åˆ†</th></tr></thead><tbody id=resultTableBody class="text-gray-700 dark:text-gray-300"></tbody></table></div><div class="mt-6 text-center"><button onclick=onReturnToTestPage() class="mr-4 px-6 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-full shadow-md transition-all"><i class="fas fa-arrow-left mr-2"></i>è¿”å›ç­”é¢˜é¡µ</button> <button onclick=onStartEvaluationClick() class="px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded-full shadow-md transition-all"><i class="fas fa-paper-plane mr-2"></i>å¼€å§‹æ‰“åˆ†</button></div></div></section><script>let remainingTime=3600,timerInterval=null,isPaused=!1,evaluationStarted=!1,emailjsReady=!1,emailSent=!1;const EMAIL_ENABLED=!1;function loadEmailJS(){return new Promise(((e,t)=>{if(window.emailjs)return emailjsReady=!0,void e();const n=document.createElement("script");n.src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js",n.async=!0,n.onload=()=>{try{emailjs.init("LoQCI3C98dk3FgEvj"),emailjsReady=!0,e()}catch(e){console.error("[EmailJS] åˆå§‹åŒ–å¤±è´¥",e),t(e)}},n.onerror=()=>{console.error("[EmailJS] åŠ è½½å¤±è´¥ï¼Œå¯èƒ½æ˜¯ç½‘ç»œé—®é¢˜"),t(new Error("SDK åŠ è½½å¤±è´¥"))},document.head.appendChild(n)}))}function updateCountdown(){const e=String(Math.floor(remainingTime/60)).padStart(2,"0"),t=String(remainingTime%60).padStart(2,"0");document.getElementById("countdown").innerText=`${e}:${t}`}function startTimer(){timerInterval&&clearInterval(timerInterval),timerInterval=setInterval((()=>{isPaused||(remainingTime--,updateCountdown(),remainingTime<=0&&(clearInterval(timerInterval),isPaused=!0,document.getElementById("testPage").classList.add("blur-overlay"),alert("æ—¶é—´å·²åˆ°ï¼Œè€ƒè¯•ç»“æŸï¼")))}),1e3)}function togglePause(){isPaused=!isPaused;const e=document.getElementById("testPage"),t=document.getElementById("pauseBtn");isPaused?(e.classList.add("blur-overlay"),t.innerHTML='<i class="fas fa-play mr-1"></i><span>ç»§ç»­</span>'):(e.classList.remove("blur-overlay"),t.innerHTML='<i class="fas fa-pause mr-1"></i><span>æš‚åœ</span>')}let hasEnteredBefore=!1;function showTestPage(){showPage("testPage"),timerInterval||startTimer(),remainingTime>0&&(isPaused=!1,document.getElementById("testPage").classList.remove("blur-overlay"),document.getElementById("pauseBtn").innerHTML='<i class="fas fa-pause mr-1"></i>æš‚åœ',hasEnteredBefore&&(document.getElementById("countdownCenterOverlay").style.display="flex"),hasEnteredBefore=!0)}function showPage(e){document.querySelectorAll(".page").forEach((e=>{e.classList.remove("active-page")})),document.getElementById(e).classList.add("active-page"),window.scrollTo(0,0),"homePage"!==e&&"completePage"!==e||(isPaused=!0,document.getElementById("testPage").classList.add("blur-overlay"))}function collectAnswers(){return{userInfo:{company:document.getElementById("company")?.value||"",name:document.getElementById("name")?.value||"",phone:document.getElementById("phone")?.value||"",email:document.getElementById("email")?.value||""},singleChoice:Array.from(document.querySelectorAll('input[type="radio"]:checked')).filter((e=>e.name.startsWith("q"))).reduce(((e,t)=>(e[t.name]=t.value,e)),{}),multipleChoice:Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).reduce(((e,t)=>{const n=t.name.replace("mq","");return e[n]||(e[n]=[]),e[n].push(t.value),e}),{}),judgment:Array.from(document.querySelectorAll('.judge-card input[type="radio"]:checked')).reduce(((e,t)=>(e[t.name]=t.value,e)),{}),essay:(()=>{const e={};return document.querySelectorAll("textarea[data-essay-id]").forEach((t=>{const n=t.dataset.essayId;e[n]=t.value.trim()})),e})()}}function renderAssessmentResult(e){const t=(new Date).toLocaleString("zh-CN",{hour12:!1});document.getElementById("resultCompany").textContent=e.userInfo.company,document.getElementById("resultName").textContent=e.userInfo.name,document.getElementById("resultEmail").textContent=e.userInfo.email,document.getElementById("resultPhone").textContent=e.userInfo.phone,document.getElementById("resultTime").textContent=t;let n=0,o=document.getElementById("resultTableBody");o.innerHTML="";const a=document.createElement("tr");a.innerHTML=`\n  <td class="border p-2">ç®€ç­”é¢˜</td>\n  <td class="border p-2">1</td>\n  <td class="border p-2">${e.essay.slice(0,30)}...</td>\n  <td class="border p-2 text-center text-gray-400 italic">-</td>\n  <td class="border p-2">${0===essayScore?"âœ˜":"âœ”"} ${essayScore}</td>\n`,o.appendChild(a),n+=essayScore,document.getElementById("resultScore").textContent=n,document.getElementById("resultLevel").textContent=n>=80?"âœ… åˆæ ¼":"âŒ ä¸åˆæ ¼"}async function exportResultToPDF(e="åŒ¿åç”¨æˆ·"){const t=document.getElementById("completePage"),n=(await html2canvas(t,{scale:2,useCORS:!0})).toDataURL("image/png"),{jsPDF:o}=window.jspdf,a=new o("p","mm","a4"),l=a.internal.pageSize.getWidth(),s=a.getImageProperties(n),r=s.height*l/s.width;a.addImage(n,"PNG",0,0,l,r),a.save(`EE-Wè¯„æµ‹ç»“æœ_${e}.pdf`)}function buildEmailHTMLTable(e){const t=(e,t,n,o,a)=>`\n    <tr>\n      <td>${e}</td>\n      <td>${t}</td>\n      <td>${n}</td>\n      <td>${o}</td>\n      <td>${a}</td>\n    </tr>`,n=[],o={single:["B","C","A","B","D","C","C","B","B","B","D","C","C","B","C","B","C","B","B","B","C","D","D","B","B"],multiple:[["A","B","D"],["C","D"],["A","B","C"],["A","B","D"],["A","B","C","D"],["A","B","C","D"],["A","B","C"],["A","B","C"],["A","B","C","D"],["A","B","C","D"],["A","B","D"],["A","B","D"],["A","B","C","D"],["A","B","C"],["A","B","C"],["A","B","C"],["A","B","C","D"],["A","B","C"],["A","B","C"],["A","B","C","D"]],judge:["true","false","false","true","true","false","true","true","false","true","false","true","false","true","false","true","true","false","true","false"]};for(let a=1;a<=25;a++){const l=`q${a}`,s=e.singleChoice[l]||"-",r=o.single[a-1],i=s===r?2:0;n.push(t("å•é€‰é¢˜",a,s,r,i))}for(let a=1;a<=20;a++){const l=a.toString(),s=(e.multipleChoice[l]||[]).join(", "),r=o.multiple[a-1].join(", "),i=s.split(", ").sort().join(",")===r.split(", ").sort().join(",")?1:0;n.push(t("å¤šé€‰é¢˜",a,s,r,i))}for(let a=1;a<=20;a++){const l=`jq${a}`,s="true"===e.judgment[l]?"âœ” æ­£ç¡®":"false"===e.judgment[l]?"âœ˜ é”™è¯¯":"-",r="true"===o.judge[a-1]?"âœ” æ­£ç¡®":"âœ˜ é”™è¯¯",i=e.judgment[l]===o.judge[a-1]?1:0;n.push(t("åˆ¤æ–­é¢˜",a,s,r,i))}const a=["ä¼ æ„Ÿå™¨","æ¸©åº¦","å·®å‹","æ•°é‡","å®‰è£…ä½ç½®","é€šä¿¡"].filter((t=>e.essay.includes(t))).length;let l=0;return a>=5?l=35:a>=3?l=25:a>=1&&(l=10),n.push(t("ç®€ç­”é¢˜",1,e.essay.slice(0,20)+"...","(å…³é”®è¯åŒ¹é…)",l)),`\n    <table border="1" cellpadding="6" cellspacing="0" style="border-collapse: collapse; width: 100%;">\n      <thead style="background-color: #f3f4f6; color: #111">\n        <tr><th>é¢˜å‹</th><th>é¢˜å·</th><th>ä½ çš„ç­”æ¡ˆ</th><th>æ­£ç¡®ç­”æ¡ˆ</th><th>å¾—åˆ†</th></tr>\n      </thead>\n      <tbody>${n.join("")}</tbody>\n    </table>`}function sendResultEmail(e){console.log("[è°ƒè¯•] é‚®ä»¶åŠŸèƒ½å·²ç¦ç”¨ï¼Œæœªæ‰§è¡Œå‘é€ã€‚")}function renderAnswersOnCompletePage(e){const t=(new Date).toLocaleString("zh-CN",{hour12:!1});document.getElementById("resultCompany").textContent=e.userInfo.company,document.getElementById("resultName").textContent=e.userInfo.name,document.getElementById("resultEmail").textContent=e.userInfo.email,document.getElementById("resultPhone").textContent=e.userInfo.phone,document.getElementById("resultTime").textContent=t;const n=document.getElementById("resultTableBody");n.innerHTML="";const o=(e,t,o)=>{const a=document.createElement("tr");a.innerHTML=`\n      <td class="border p-2">${e}</td>\n      <td class="border p-2">${t}</td>\n      <td class="border p-2">${o}</td>\n      <td class="border p-2 text-gray-400 italic">-</td>\n      <td class="border p-2 text-gray-400 italic">-</td>\n    `,n.appendChild(a)};for(let t=1;t<=25;t++){const n=`q${t}`;o("å•é€‰é¢˜",t,e.singleChoice[n]||"æœªç­”")}for(let t=1;t<=20;t++){const n=t.toString();o("å¤šé€‰é¢˜",t,(e.multipleChoice[n]||[]).join(", ")||"æœªç­”")}for(let t=1;t<=20;t++){const n=`jq${t}`,a=e.judgment[n];o("åˆ¤æ–­é¢˜",t,"true"===a?"âœ” æ­£ç¡®":"false"===a?"âœ˜ é”™è¯¯":"æœªç­”")}o("ç®€ç­”é¢˜",1,e.essay.slice(0,50)+(e.essay.length>50?"...":""))}async function handleExport(){if(!validateForm())return void alert("è¯·å®Œå–„å¿…å¡«ä¿¡æ¯å’Œç­”é¢˜å†…å®¹åå†æäº¤ï¼");const e=document.getElementById("loading");e?.classList.remove("hidden");try{await new Promise((e=>setTimeout(e,300)));const e=collectAnswers();showPage("completePage"),renderAssessmentResult(e),evaluationStarted=!0,setTimeout((()=>{const t=document.getElementById("completePage"),n=e.userInfo.name||"åŒ¿å";html2pdf().from(t).set({margin:[10,10,10,10],filename:`EE-Wè¯„æµ‹ç»“æœ_${n}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"},pagebreak:{mode:["css","legacy"]}}).save().then((()=>{console.log("[PDF] å¯¼å‡ºæˆåŠŸ")})).catch((e=>{console.error("[PDF] å¯¼å‡ºå¤±è´¥",e)}))}),1e3);const t=generateEmailTableHTML(e),n={company:e.userInfo.company,user_name:e.userInfo.name,phone:e.userInfo.phone,user_email:e.userInfo.email,timestamp:(new Date).toLocaleString("zh-CN",{hour12:!1}),message:"ç³»ç»Ÿè‡ªåŠ¨æäº¤ï¼šEE-Wäº§å“åŸ¹è®­ç­”å·",table_html:t};if(window.emailjs)emailjs.init("LoQCI3C98dk3FgEvj"),emailjs.send("service_csl8frv","template_0v2mqw9",n).then((()=>console.log("[EmailJS] é‚®ä»¶å‘é€æˆåŠŸ"))).catch((e=>{console.error("[EmailJS] é‚®ä»¶å¤±è´¥",e),showEmailResultPopup("âŒ é‚®ä»¶å‘é€å¤±è´¥ï¼Œæ˜¯å¦é‡æ–°å‘é€ï¼Ÿ")}));else{const e=document.createElement("script");e.src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js",e.onload=()=>{emailjs.init("LoQCI3C98dk3FgEvj"),emailjs.send("service_csl8frv","template_0v2mqw9",n).then((()=>console.log("[EmailJS] é‚®ä»¶å‘é€æˆåŠŸ"))).catch((e=>{console.error("[EmailJS] é‚®ä»¶å¤±è´¥",e),alert("âš ï¸ é‚®ä»¶å‘é€å¤±è´¥ï¼Œè¯·å°†å¯¼å‡ºçš„ PDF æ‰‹åŠ¨å‘é€åˆ° RSEC é‚®ç®±ï¼šrsec@armstrong.com"),showEmailResultPopup("âŒ é‚®ä»¶å‘é€å¤±è´¥ï¼Œæ˜¯å¦é‡æ–°å‘é€ï¼Ÿ")}))},document.head.appendChild(e)}}catch(e){console.error("æäº¤å¤±è´¥ï¼š",e),alert("æäº¤å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•ã€‚\né”™è¯¯ä¿¡æ¯ï¼š"+e.message)}finally{e?.classList.add("hidden")}}function validateForm(){return console.warn("[è°ƒè¯•æ¨¡å¼] è¡¨å•éªŒè¯å·²è·³è¿‡"),!0}function promptPasswordAndSend(e){document.getElementById("passwordModal").classList.remove("hidden"),window.confirmPassword=async function(t){const n=document.getElementById("passwordInput").value.trim();showUniversalModal("åŠ¨æ€éªŒè¯ç ","è¯·è¾“å…¥éªŒè¯ç ä»¥å‘é€æˆç»©",!0,(e=>{if("AFT2025"===e){const e=buildEmailTable();sendResultEmail(e)}else alert("éªŒè¯ç é”™è¯¯")}));const o="AFT2025"===n;await exportResultPDF(e),t&&o?await sendResultEmail(e):t&&!o?alert("âŒ åŠ¨æ€å£ä»¤é”™è¯¯ï¼Œæœªå‘é€é‚®ä»¶ï¼Œä»…å¯¼å‡º PDFã€‚"):alert("âœ… å·²è·³è¿‡é‚®ä»¶ï¼Œä»…ä¿å­˜æœ¬åœ° PDFã€‚")}}async function exportResultPDF(e){const t=document.getElementById("completePage"),n=e.userInfo.name||"æœªå‘½å";await html2pdf().from(t).set({margin:0,filename:`EE-Wè¯„æµ‹ç»“æœ_${n}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}}).save()}async function sendResultEmail(e){const t=generateEmailTableHTML(e),n={company:e.userInfo.company,user_name:e.userInfo.name,phone:e.userInfo.phone,user_email:e.userInfo.email,timestamp:(new Date).toLocaleString("zh-CN",{hour12:!1}),message:"EE-Wäº§å“åŸ¹è®­è‡ªåŠ¨æäº¤ç­”å·",table_html:t};try{window.emailjs||await new Promise((e=>{const t=document.createElement("script");t.src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js",t.onload=e,document.head.appendChild(t)})),emailjs.init("LoQCI3C98dk3FgEvj"),await emailjs.send("service_csl8frv","template_0v2mqw9",n),alert("âœ… é‚®ä»¶å·²æˆåŠŸå‘é€ï¼")}catch(e){console.error("[EmailJS] é‚®ä»¶å‘é€å¤±è´¥ï¼š",e),showEmailResultPopup("âŒ é‚®ä»¶å‘é€å¤±è´¥ï¼Œæ˜¯å¦é‡æ–°å‘é€ï¼Ÿ")}}function sendEmailWithTemplate(e,t=null,n=null){const o="service_csl8frv",a="template_0v2mqw9",l="LoQCI3C98dk3FgEvj";if("undefined"==typeof emailjs){const s=document.createElement("script");s.src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js",s.onload=()=>{emailjs.init(l),emailjs.send(o,a,e).then((()=>{console.log("[EmailJS] é‚®ä»¶å‘é€æˆåŠŸ"),alert("âœ… è¯„æµ‹ç»“æœå·²æˆåŠŸå‘é€è‡³ RSEC é‚®ç®±ï¼"),"function"==typeof t&&t()})).catch((e=>{console.error("[EmailJS] é‚®ä»¶å‘é€å¤±è´¥:",e),showEmailResultPopup("âŒ é‚®ä»¶å‘é€å¤±è´¥ï¼Œæ˜¯å¦é‡æ–°å‘é€ï¼Ÿ"),"function"==typeof n&&n(e)}))},s.onerror=()=>{console.error("[EmailJS] æ¨¡å—åŠ è½½å¤±è´¥"),"function"==typeof n&&n(new Error("æ¨¡å—åŠ è½½å¤±è´¥"))},document.head.appendChild(s)}else emailjs.init(l),emailjs.send(o,a,e).then((()=>{console.log("[EmailJS] é‚®ä»¶å‘é€æˆåŠŸ"),alert("âœ… è¯„æµ‹ç»“æœå·²æˆåŠŸå‘é€è‡³ RSEC é‚®ç®±ï¼"),"function"==typeof t&&t()})).catch((e=>{console.error("[EmailJS] é‚®ä»¶å‘é€å¤±è´¥:",e),showEmailResultPopup("âŒ é‚®ä»¶å‘é€å¤±è´¥ï¼Œæ˜¯å¦é‡æ–°å‘é€ï¼Ÿ"),"function"==typeof n&&n(e)}))}function generateEmailTableHTML(e){let t=`\n  <style>\n    table { border-collapse: collapse; width: 100%; margin-bottom: 20px; font-family: sans-serif; font-size: 14px; }\n    th, td { border: 1px solid #ccc; padding: 6px 10px; text-align: center; }\n    thead { background-color: #f3f4f6; color: #111827; }\n    .title { background-color: #ef4444; color: white; font-weight: bold; }\n  </style>\n\n  <h2 style="margin-top: 0;">ğŸ“‹ ç­”é¢˜è¯„ä¼°ç»“æœ</h2>\n  <p><strong>å…¬å¸åç§°ï¼š</strong>${e.userInfo.company}</p>\n  <p><strong>å§“åï¼š</strong>${e.userInfo.name}</p>\n  <p><strong>é‚®ç®±ï¼š</strong>${e.userInfo.email}</p>\n  <p><strong>ç”µè¯ï¼š</strong>${e.userInfo.phone}</p>\n  <p><strong>æäº¤æ—¶é—´ï¼š</strong>${(new Date).toLocaleString("zh-CN",{hour12:!1})}</p>\n  `;const n={single:["B","C","A","B","D","C","C","B","B","B","D","C","C","B","C","B","C","B","B","B","C","D","D","B","B"],multiple:[["A","B","D"],["C","D"],["A","B","C"],["A","B","D"],["A","B","C","D"],["A","B","C","D"],["A","B","C"],["A","B","C"],["A","B","C","D"],["A","B","C","D"],["A","B","D"],["A","B","D"],["A","B","C","D"],["A","B","C"],["A","B","C"],["A","B","C"],["A","B","C","D"],["A","B","C"],["A","B","C"],["A","B","C","D"]],judge:["true","false","false","true","true","false","true","true","false","true","false","true","false","true","false","true","true","false","true","false"]},o=(e,n,o,a,l)=>{let s="";for(let t=1;t<=n;t++){s+=`<tr>\n        <td>${e}</td>\n        <td>${t}</td>\n        <td>${o(t)}</td>\n        <td>${a(t)}</td>\n        <td>${l(t)}</td>\n      </tr>`}t+=`\n      <table>\n        <thead class="title"><tr><th colspan="5">${e}</th></tr></thead>\n        <thead><tr><th>é¢˜å‹</th><th>é¢˜å·</th><th>ä½ çš„ç­”æ¡ˆ</th><th>æ­£ç¡®ç­”æ¡ˆ</th><th>å¾—åˆ†</th></tr></thead>\n        <tbody>${s}</tbody>\n      </table>`};o("å•é€‰é¢˜",25,(t=>e.singleChoice[`q${t}`]||"æœªç­”"),(e=>n.single[e-1]),(t=>e.singleChoice[`q${t}`]===n.single[t-1]?2:0)),o("å¤šé€‰é¢˜",20,(t=>(e.multipleChoice[t]||[]).join(", ")||"æœªç­”"),(e=>n.multiple[e-1].join(", ")),(t=>{const o=(e.multipleChoice[t]||[]).sort(),a=n.multiple[t-1].sort();return JSON.stringify(o)===JSON.stringify(a)?1:0})),o("åˆ¤æ–­é¢˜",20,(t=>{const n=e.judgment[`jq${t}`];return"true"===n?"âœ” æ­£ç¡®":"false"===n?"âœ˜ é”™è¯¯":"æœªç­”"}),(e=>"true"===n.judge[e-1]?"âœ” æ­£ç¡®":"âœ˜ é”™è¯¯"),(t=>e.judgment[`jq${t}`]===n.judge[t-1]?1:0));const a=e.essay||"",l=["ä¼ æ„Ÿå™¨","æ¸©åº¦","å·®å‹","æ•°é‡","å®‰è£…ä½ç½®","é€šä¿¡"].filter((e=>a.includes(e))).length;return t+=`\n    <table>\n      <thead class="title"><tr><th colspan="5">ç®€ç­”é¢˜</th></tr></thead>\n      <tbody><tr><td colspan="5" style="text-align: left;">${a||"æœªä½œç­”"}<br/><strong>å¾—åˆ†ï¼š</strong>${l>=5?35:l>=3?25:l>=1?10:0}ï¼ˆåŒ¹é…å…³é”®è¯ï¼š${l}ï¼‰</td></tr></tbody>\n    </table>`,t}async function handleScreenshotAndEmail(){try{const e=collectAnswers(),t=e.userInfo.name||"åŒ¿åç”¨æˆ·",n=document.getElementById("completePage");await html2pdf().from(n).set({margin:0,filename:`EE-Wè¯„æµ‹ç»“æœ_${t}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}}).save();const o=generateEmailTableHTML(e),a={company:e.userInfo.company,user_name:t,phone:e.userInfo.phone,user_email:e.userInfo.email,timestamp:(new Date).toLocaleString("zh-CN",{hour12:!1}),message:"ç³»ç»Ÿè‡ªåŠ¨æäº¤ï¼šEE-Wäº§å“åŸ¹è®­ç­”å·ï¼ˆæ‰‹åŠ¨è§¦å‘ï¼‰",table_html:o};emailjs.send("service_csl8frv","template_0v2mqw9",a).then((()=>alert("âœ… é‚®ä»¶å·²æˆåŠŸå‘é€ï¼"))).catch((e=>{console.error("[EmailJS] é‚®ä»¶å‘é€å¤±è´¥ï¼š",e),showEmailResultPopup("âŒ é‚®ä»¶å‘é€å¤±è´¥ï¼Œæ˜¯å¦é‡æ–°å‘é€ï¼Ÿ")}))}catch(e){console.error("[å‘é€é”™è¯¯]ï¼š",e),alert("âŒ å‡ºç°é”™è¯¯ï¼Œæ— æ³•å®Œæˆæ“ä½œï¼Œè¯·ç¨åé‡è¯•ï¼")}}function confirmStartEvaluation(){if(confirm("æ‚¨ç¡®å®šå¼€å§‹è¿›è¡Œè¯„æµ‹å—ï¼Ÿ\næäº¤åå°†è‡ªåŠ¨æ¨é€ç»™ Armstrong RSEC éƒ¨é—¨ï¼Œå¹¶å¯¼å‡º PDFã€‚")){const e=sessionStorage.getItem("userAnswers");if(!e)return void alert("âš ï¸ æ— æ³•è·å–ç­”é¢˜æ•°æ®ï¼Œè¯·é‡æ–°æäº¤ï¼");const t=JSON.parse(e);sessionStorage.setItem("hasEvaluated","true"),promptPasswordAndSend(t)}else alert("å·²å–æ¶ˆè¯„æµ‹ï¼Œæ‚¨å¯ç»§ç»­æ£€æŸ¥ç­”é¢˜å†…å®¹ã€‚")}function returnToTestPage(){"true"!==sessionStorage.getItem("hasEvaluated")?(showPage("testPage"),document.querySelectorAll('input[type="radio"]:checked, input[type="checkbox"]:checked').forEach((e=>e.checked=!1)),document.getElementById("essay").value="",window.scrollTo(0,0)):alert("âš ï¸ æ‚¨å·²å®Œæˆè¯„æµ‹ï¼Œå¸¦æœ‰å®Œæˆæ—¶é—´çš„ç»“æœå·²ç»å‘é€å‡ºå»ï¼Œæ— æ³•è¿”å›ä¿®æ”¹ç­”å·ï¼")}function startEvaluationPrompt(){confirm("æ‚¨ç¡®å®šè¦å¼€å§‹è¿›è¡Œè¯„æµ‹å—ï¼Ÿ\nè¯„æµ‹åå°†è‡ªåŠ¨å¯¼å‡º PDFï¼Œå¹¶å‘é€ç»“æœè‡³ Armstrong RSECã€‚")?promptPasswordAndSend():alert("å·²å–æ¶ˆè¯„æµ‹æ“ä½œã€‚æ‚¨ä»å¯æ£€æŸ¥ç­”é¢˜å†…å®¹ã€‚")}function onStartEvaluationClick(){confirm("æ‚¨ç¡®å®šå¼€å§‹è¿›è¡Œè¯„æµ‹å—ï¼Ÿ\n\nä¸€æ—¦å¼€å§‹ï¼Œå°†æ— æ³•è¿”å›æµ‹è¯•é¡µï¼Œå¹¶ä¼šå¯¼å‡º PDFã€æ¨é€ç»“æœåˆ° Armstrong RSECã€‚")&&promptPasswordAndSend()}function promptPasswordAndSend(){const e=prompt("è¯·è¾“å…¥åŠ¨æ€å£ä»¤ï¼ˆå¦‚ç”± RSEC éƒ¨é—¨æä¾›ï¼‰ï¼š");if(!e)return alert("æœªè¾“å…¥éªŒè¯ç ï¼Œæ“ä½œå·²å–æ¶ˆã€‚");if("AFT2025"===e){const e=collectAnswers();renderAssessmentResult(e),exportPDF(e),sendEmailResult(e),evaluationStarted=!0}else{const e=collectAnswers();evaluationStarted=!0,renderAssessmentResult(e),exportPDF(e),alert("åŠ¨æ€éªŒè¯ç é”™è¯¯ï¼Œä»…å¯¼å‡º PDFï¼Œæœªå‘é€é‚®ä»¶ï¼Œè¯·è”ç³»ç®¡ç†å‘˜ã€‚")}}function exportPDF(e){const t=e.userInfo.name||"åŒ¿åç”¨æˆ·",n=document.getElementById("completePage");html2pdf().from(n).set({margin:[10,10,10,10],filename:`EE-Wè¯„æµ‹ç»“æœ_${t}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0,scrollX:0,scrollY:0,windowWidth:n.scrollWidth,windowHeight:n.scrollHeight},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}}).save()}function sendEmailResult(e){const t=generateEmailTableHTML(e),n={company:e.userInfo.company,user_name:e.userInfo.name,phone:e.userInfo.phone,user_email:e.userInfo.email,timestamp:(new Date).toLocaleString("zh-CN",{hour12:!1}),message:"ç³»ç»Ÿè‡ªåŠ¨æäº¤ï¼šEE-Wäº§å“åŸ¹è®­ç­”å·",table_html:t};emailjs.send("service_csl8frv","template_0v2mqw9",n).then((()=>{console.log("âœ… é‚®ä»¶å‘é€æˆåŠŸ"),alert("âœ… è¯„æµ‹ç»“æœå·²æˆåŠŸå‘é€è‡³ RSEC é‚®ç®±ï¼")})).catch((e=>{console.error("[EmailJS] é‚®ä»¶å¤±è´¥",e),showEmailResultPopup("âŒ é‚®ä»¶å‘é€å¤±è´¥ï¼Œæ˜¯å¦é‡æ–°å‘é€ï¼Ÿ")}))}function onReturnToTestPage(){if(evaluationStarted)return void alert("âš ï¸ è¯„æµ‹å·²å¼€å§‹ï¼Œæ— æ³•è¿”å›ç­”é¢˜é¡µï¼");const e=collectAnswers();showPage("testPage"),document.getElementById("company").value=e.userInfo.company,document.getElementById("name").value=e.userInfo.name,document.getElementById("email").value=e.userInfo.email,document.getElementById("phone").value=e.userInfo.phone}function showRetryModal(){document.getElementById("emailRetryModal").classList.remove("hidden")}function closeRetryModal(){document.getElementById("emailRetryModal").classList.add("hidden")}console.log("ç»‘å®š retryEmailBtn...");const btn=document.getElementById("retryEmailBtn");function reinitializeEmailJS(){if(window.emailjs)try{emailjs.init("LoQCI3C98dk3FgEvj"),console.log("âœ… EmailJS å·²é‡æ–°åˆå§‹åŒ–")}catch(e){console.error("âŒ EmailJS åˆå§‹åŒ–å¤±è´¥",e)}else console.error("âš ï¸ EmailJS æ¨¡å—æœªåŠ è½½")}function retryEmailSend(){hideEmailResultPopup(),reinitializeEmailJS(),setTimeout((()=>{handleExportWithPDFAndEmail()}),200)}function showEmailResultPopup(e){const t=`\n    <div id="emailResultPopup" class="fixed inset-0 bg-black bg-opacity-50 z-[9999] flex items-center justify-center">\n      <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 w-[300px] text-center fade-in-bounce">\n        <p class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4">${e}</p>\n        <div class="flex justify-center gap-4">\n          <button id="retrySendBtn" class="bg-blue-600 text-white px-4 py-1.5 rounded hover:bg-blue-700">æ˜¯</button>\n          <button id="cancelSendBtn" class="bg-gray-300 text-gray-800 px-4 py-1.5 rounded hover:bg-gray-400">å¦</button>\n        </div>\n      </div>\n    </div>\n  `;document.body.insertAdjacentHTML("beforeend",t),document.getElementById("retrySendBtn").onclick=()=>{document.getElementById("emailResultPopup").remove(),emailjs.init("LoQCI3C98dk3FgEvj");try{handleExportWithPDFAndEmail(!0)}catch(e){alert("é‚®ä»¶å†æ¬¡å‘é€å¤±è´¥ï¼Œè¯·ç¨åå†è¯•ã€‚")}},document.getElementById("cancelSendBtn").onclick=()=>{document.getElementById("emailResultPopup").remove()}}console.log("retryEmailBtn =",btn),btn?btn.addEventListener("click",(()=>{if(closeRetryModal(),window.emailjs)try{emailjs.init("LoQCI3C98dk3FgEvj")}catch(e){console.error("EmailJS åˆå§‹åŒ–å¤±è´¥",e)}handleEmailSendAgain()})):console.warn("âš ï¸ æ²¡æœ‰æ‰¾åˆ° #retryEmailBtnï¼Œè·³è¿‡ç»‘å®š")</script><script>document.addEventListener("DOMContentLoaded",(()=>{for(let e=0;e<30;e++){const e=document.createElement("div");e.className="watermark-random",e.style.top=120*Math.random()-10+"vh",e.style.left=120*Math.random()-10+"vw",e.style.transform=`rotate(30deg) scale(${.7+.6*Math.random()})`,document.body.appendChild(e)}}))</script><div id=passwordModal class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center"><div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md w-full max-w-sm text-center"><h3 class="text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4">è¯·è¾“å…¥åŠ¨æ€å£ä»¤ä»¥å‘é€è¯„æµ‹ç»“æœè‡³é‚®ç®±</h3><input id=passwordInput type=password placeholder=è¯·è¾“å…¥å£ä»¤... class="w-full p-2 border rounded-md mb-4 focus:outline-none focus:ring focus:border-blue-300"><div class="flex justify-between space-x-4"><button onclick=confirmPassword(!0) class="flex-1 bg-green-600 hover:bg-green-700 text-white py-2 rounded">ç¡®å®š</button> <button onclick=confirmPassword(!1) class="flex-1 bg-gray-400 hover:bg-gray-500 text-white py-2 rounded">è·³è¿‡å‘é€</button></div></div></div><div id=countdownCenterOverlay class="hidden fixed inset-0 flex"><div class=text-center><p>å½“å‰è€ƒè¯•å·²æš‚åœ</p><p>ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å¯æ¢å¤è€ƒè¯•</p><button onclick=resumeFromCenterOverlay()>ç»§ç»­ç­”é¢˜</button></div></div><script>document.addEventListener("DOMContentLoaded",(function(){startTimer()}))</script><div id=emailRetryModal class="fixed inset-0 z-50 hidden bg-black bg-opacity-50 flex items-center justify-center"><div class="bg-white dark:bg-gray-800 rounded-xl p-6 w-80 text-center shadow-lg"><p class="text-lg font-semibold text-gray-900 dark:text-white mb-4">é‚®ä»¶å‘é€å¤±è´¥ï¼Œæ˜¯å¦é‡è¯•ï¼Ÿ</p><div class="flex justify-center gap-4"><button id=retryEmailBtn onclick=retryEmailSend() class="bg-green-500 hover:bg-green-600 ...">æ˜¯ï¼Œé‡æ–°å‘é€</button> <button id=retryEmailBtn onclick=hideEmailResultPopup() class="bg-gray-400 hover:bg-gray-500 ...">å¦ï¼Œæš‚ä¸å‘é€</button></div></div></div><script src=https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js></script><script>if(void 0===currentLang)var currentLang="zh";function loadQuestionsFromCSV(t){Papa.parse(t,{download:!0,header:!0,complete:function(t){const n=t.data.filter((t=>"ç®€ç­”é¢˜"===t["é¢˜å‹"]));if(n.length>0){const t=n[0],e=document.querySelector("#short1");if(e){const n="en"===currentLang?t["English Question"]:t["ä¸­æ–‡é¢˜å¹²"];e.querySelector("h3").textContent=n}}}})}function switchLanguage(t){currentLang=t,loadQuestionsFromCSV("/static/csv/EE-W.csv")}window.addEventListener("DOMContentLoaded",(()=>{loadQuestionsFromCSV("/static/csv/EE-W.csv")}))</script><script src=https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js></script><script>if(void 0===currentLang)var currentLang="zh";document.addEventListener("DOMContentLoaded",(function(){Papa.parse("/static/csv/EE-W.csv",{download:!0,header:!0,complete:function(e){const n=e.data;n.filter((e=>"å•é€‰é¢˜"===e["é¢˜å‹"])).forEach(((e,n)=>{const t=n+1,r=document.querySelector(`#q${t}`);if(!r)return;const o="en"===currentLang?e["English Question"]:e["ä¸­æ–‡é¢˜å¹²"],c=r.querySelector("h3");c&&(c.textContent=`${t}. ${o}`),["A","B","C","D"].forEach((n=>{const o=r.querySelector(`label[for="q${t}-${n}"]`),c="en"===currentLang?e[n+"_EN"]:e[n];o&&c&&(o.innerHTML=`<input type="radio" id="q${t}-${n}" name="q${t}" value="${n}"> ${n}. ${c}`)}))})),n.filter((e=>"å¤šé€‰é¢˜"===e["é¢˜å‹"])).forEach(((e,n)=>{const t=n+1,r=document.querySelector(`#multi${t}`);if(!r)return;const o="en"===currentLang?e["English Question"]:e["ä¸­æ–‡é¢˜å¹²"],c=r.querySelector("h3");c&&(c.textContent=`${t}. ${o}`),["A","B","C","D","E","F"].forEach((n=>{const o=r.querySelector(`label[for="m${t}-${n}"]`),c="en"===currentLang?e[n+"_EN"]:e[n];o&&c&&(o.innerHTML=`<input type="checkbox" id="m${t}-${n}" name="multi${t}" value="${n}"> ${n}. ${c}`)}))})),n.filter((e=>"åˆ¤æ–­é¢˜"===e["é¢˜å‹"])).forEach(((e,n)=>{const t=n+1,r=document.querySelector(`#jq${t}`);if(!r)return;const o="en"===currentLang?e["English Question"]:e["ä¸­æ–‡é¢˜å¹²"],c=r.querySelector("h3");c&&(c.textContent=`${t}. ${o}`)}));const t=n.find((e=>"ç®€ç­”é¢˜"===e["é¢˜å‹"])),r=document.querySelector("#short1");if(t&&r){const e="en"===currentLang?t["English Question"]:t["ä¸­æ–‡é¢˜å¹²"],n=r.querySelector("h3");n&&(n.textContent=e)}},error:function(e){console.error("âŒ é¢˜åº“åŠ è½½å¤±è´¥ï¼š",e)}})}))</script><script>let lastActivityTime=Date.now();const recordActivity=()=>{lastActivityTime=Date.now()};["mousemove","mousedown","keydown","scroll","touchstart"].forEach((t=>{document.addEventListener(t,recordActivity)})),setInterval((()=>{Date.now()-lastActivityTime<6e4&&fetch("/heartbeat").then((t=>{440===t.status&&(alert("ç™»å½•å·²è¶…æ—¶ï¼Œè¯·é‡æ–°ç™»å½•ï¼"),window.location.href="/login")})).catch((()=>{}))}),6e4)</script><div id=loginOverlay class="hidden fixed inset-0 bg-black/40 backdrop-blur-sm z-50 flex items-center justify-center"><div class="bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-xs shadow-xl"><h2 class="text-lg font-bold text-center mb-4">ä¼šè¯å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•</h2><input id=reLoginUser class="w-full mb-3 px-4 py-2 rounded-md bg-gray-100 dark:bg-gray-700" placeholder=ç”¨æˆ·å> <input id=reLoginPass type=password class="w-full mb-3 px-4 py-2 rounded-md bg-gray-100 dark:bg-gray-700" placeholder=å¯†ç > <button onclick=submitRelogin() class="w-full py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">é‡æ–°ç™»å½•</button></div></div><script>function showLoginOverlay(){document.getElementById("loginOverlay").classList.remove("hidden")}async function submitRelogin(){const e=document.getElementById("reLoginUser").value.trim(),n=document.getElementById("reLoginPass").value.trim();(await fetch("/login",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({username:e,password:n})})).redirected?location.reload():alert("é‡æ–°ç™»å½•å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç”¨æˆ·åæˆ–å¯†ç ")}document.getElementById("reLoginPass").addEventListener("keyup",(function(e){"Enter"===e.key&&submitRelogin()}))</script><script>function closeLoginOverlay(){document.getElementById("loginOverlay").classList.add("hidden")}</script><script src=https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js></script><script>if(void 0===currentLang)var currentLang="zh";document.addEventListener("DOMContentLoaded",(function(){Papa.parse("/static/csv/EE-W.csv",{download:!0,header:!0,complete:function(e){const n=e.data;n.filter((e=>"å•é€‰é¢˜"===e["é¢˜å‹"])).forEach(((e,n)=>{const t=n+1,r=document.querySelector(`#q${t}`);if(!r)return;const o="en"===currentLang?e["English Question"]:e["ä¸­æ–‡é¢˜å¹²"],c=r.querySelector("h3");c&&(c.textContent=`${t}. ${o}`),["A","B","C","D"].forEach((n=>{const o=r.querySelector(`label[for="q${t}-${n}"]`),c="en"===currentLang?e[n+"_EN"]:e[n];o&&c&&(o.innerHTML=`<input type="radio" id="q${t}-${n}" name="q${t}" value="${n}"> ${n}. ${c}`)}))})),n.filter((e=>"å¤šé€‰é¢˜"===e["é¢˜å‹"])).forEach(((e,n)=>{const t=n+1,r=document.querySelector(`#multi${t}`);if(!r)return;const o="en"===currentLang?e["English Question"]:e["ä¸­æ–‡é¢˜å¹²"],c=r.querySelector("h3");c&&(c.textContent=`${t}. ${o}`),["A","B","C","D","E","F"].forEach((n=>{const o=r.querySelector(`label[for="m${t}-${n}"]`),c="en"===currentLang?e[n+"_EN"]:e[n];o&&c&&(o.innerHTML=`<input type="checkbox" id="m${t}-${n}" name="multi${t}" value="${n}"> ${n}. ${c}`)}))})),n.filter((e=>"åˆ¤æ–­é¢˜"===e["é¢˜å‹"])).forEach(((e,n)=>{const t=n+1,r=document.querySelector(`#jq${t}`);if(!r)return;const o="en"===currentLang?e["English Question"]:e["ä¸­æ–‡é¢˜å¹²"],c=r.querySelector("h3");c&&(c.textContent=`${t}. ${o}`)}));const t=n.find((e=>"ç®€ç­”é¢˜"===e["é¢˜å‹"])),r=document.querySelector("#short1");if(t&&r){const e="en"===currentLang?t["English Question"]:t["ä¸­æ–‡é¢˜å¹²"],n=r.querySelector("h3");n&&(n.textContent=e)}},error:function(e){console.error("âŒ é¢˜åº“åŠ è½½å¤±è´¥ï¼š",e)}})}))</script><script src=/static/common/render.js></script><script>document.addEventListener("DOMContentLoaded",(function(){loadCSVAndRender("/static/csv/EE-W.csv","zh")}))</script><div id=universalModal class="fixed z-50 inset-0 overflow-y-auto bg-gray-800 bg-opacity-50 flex items-center justify-center hidden"><div class="bg-white dark:bg-gray-900 p-6 rounded-lg shadow-lg w-full max-w-md text-center"><h2 id=modalTitle class="text-xl font-semibold mb-4 text-gray-800 dark:text-gray-100">æç¤ºæ ‡é¢˜</h2><p id=modalMessage class="text-gray-700 dark:text-gray-300 mb-6">æç¤ºå†…å®¹æ–‡æœ¬ï¼Œå¯æ ¹æ®å®é™…å†…å®¹åŠ¨æ€è®¾ç½®</p><input id=modalInput class="bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 border border-gray-300 dark:border-gray-600 rounded p-2 w-full mb-4 hidden" type=text placeholder=è¯·è¾“å…¥å†…å®¹><div class="flex justify-end gap-4"><button id=modalConfirmBtn class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded">ç¡®å®š</button> <button onclick=closeUniversalModal() class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded">å–æ¶ˆ</button></div></div></div><script>window.addEventListener("DOMContentLoaded",(()=>{const e=document.documentElement,t=document.getElementById("themeToggle"),s=localStorage.getItem("theme");if("dark"===s)e.classList.add("dark"),console.log("[Init] æ¢å¤ä¸º dark æ¨¡å¼");else if("light"===s)e.classList.remove("dark"),console.log("[Init] æ¢å¤ä¸º light æ¨¡å¼");else{const t=window.matchMedia("(prefers-color-scheme: dark)").matches;e.classList.toggle("dark",t),localStorage.setItem("theme",t?"dark":"light")}t&&t.addEventListener("click",(()=>{const t=e.classList.contains("dark");e.classList.toggle("dark"),localStorage.setItem("theme",t?"light":"dark")}))}))</script><script>function positionCountdownBar(){const n=document.getElementById("mainNavbar"),t=document.getElementById("examStatusBar");if(n&&t){const o=n.getBoundingClientRect(),e=window.scrollY||window.pageYOffset,d=o.bottom+e;t.style.top=`${d+0}px`}}window.addEventListener("DOMContentLoaded",positionCountdownBar),window.addEventListener("resize",positionCountdownBar)</script></div><script>const isLocalhost="localhost"===location.hostname||"127.0.0.1"===location.hostname;isLocalhost||(document.addEventListener("contextmenu",(e=>e.preventDefault())),document.addEventListener("keydown",(e=>{("F12"===e.key||e.ctrlKey&&e.shiftKey&&["I","J","C"].includes(e.key.toUpperCase())||e.ctrlKey&&"U"===e.key.toUpperCase())&&e.preventDefault()})))</script></body></html>